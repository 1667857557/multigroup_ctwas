<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Run on summary statistics data • ctwas</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Run on summary statistics data">
<meta property="og:description" content="ctwas">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ctwas</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.26</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/ctwas_idv_wkfl.html">Run on individual-level data</a>
    </li>
    <li>
      <a href="../articles/ctwas_rss_wkfl.html">Run on summary statistics data</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/simingz/ctwas">Source</a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="ctwas_rss_wkfl_files/header-attrs-2.6/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Run on summary statistics data</h1>
            
      
      
      <div class="hidden name"><code>ctwas_rss_wkfl.Rmd</code></div>

    </div>

    
    
<div id="purpose-of-the-analysis" class="section level1">
<h1 class="hasAnchor">
<a href="#purpose-of-the-analysis" class="anchor"></a>Purpose of the analysis</h1>
<p>This workflow aims to use GWAS summary statistics data as input and implements the causal TWAS algorithm. The “causal TWAS” method is developed to identify causal genes in GWAS studies. We improve the current TWAS analysis mainly by reducing false positives. We start from z scores for each SNP in a GWAS study and expression model trained by the <a href="http://gusevlab.org/projects/fusion/">Fusion/TWAS software</a>. In the end, we will provide a PIP (the posterior inclusion probality for being a causal gene) for each gene with an expression model.</p>
<p>Below is the workflow for running <code>ctwas</code> for summary statistics data. We provided example input files with the package and you can use the following code as a toy pipeline. You can prepare your own input files following the examples.</p>
</div>
<div id="prepare-input" class="section level1">
<h1 class="hasAnchor">
<a href="#prepare-input" class="anchor"></a>Prepare Input</h1>
<p>Our package is called <code>ctwas</code>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">ctwas</span><span class="op">)</span></code></pre></div>
<p>The example inputs are given as below:</p>
<ul>
<li>z scores, a data frame:</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># z scores</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">z_snp</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">z_snp</span><span class="op">)</span>
<span class="co">#&gt;       id A1 A2          z</span>
<span class="co">#&gt; 1 rs1001  G  A  -6.644254</span>
<span class="co">#&gt; 2 rs1002  C  T  14.369485</span>
<span class="co">#&gt; 3 rs1003  G  A -14.180414</span>
<span class="co">#&gt; 4 rs1004  C  T  -6.739014</span>
<span class="co">#&gt; 5 rs1005  G  A -14.049735</span>
<span class="co">#&gt; 6 rs1006  C  T  -2.176475</span></code></pre></div>
<p>Here, A1 is effect allele. A2 is the other allele. z indicates the z score from GWAS.</p>
<ul>
<li>LD reference data.</li>
</ul>
<p>There are two ways to provide LD information for the functions in ctwas. One is to provide LD genotype data (in plink format), the other way is to provide genetic correlation matrix (R matrix) for LD indpendent regions.</p>
<p><strong>If you want to provide LD genotype type</strong>, then you need to provide a character vector of .pgen or .bed files. One file for one chromosome, in the order of 1 to 22. Therefore, the length of this vector needs to be 22. If .pgen files are given, then .pvar and .psam are assumed to present in the same directory. If .bed files are given, then .bim and .fam files are assumed to present in the same directory. For example:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># genotype for LD reference</span>
<span class="va">ld_pgenfs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"extdata/example_genotype_files"</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"example_chr"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">22</span>, <span class="st">".pgen"</span><span class="op">)</span>, package <span class="op">=</span> <span class="st">"ctwas"</span><span class="op">)</span>
<span class="va">ld_pgenfs</span>
<span class="co">#&gt;  [1] "/tmp/Rtmpaaycpe/temp_libpath6e24f5908f2/ctwas/extdata/example_genotype_files/example_chr1.pgen" </span>
<span class="co">#&gt;  [2] "/tmp/Rtmpaaycpe/temp_libpath6e24f5908f2/ctwas/extdata/example_genotype_files/example_chr2.pgen" </span>
<span class="co">#&gt;  [3] "/tmp/Rtmpaaycpe/temp_libpath6e24f5908f2/ctwas/extdata/example_genotype_files/example_chr3.pgen" </span>
<span class="co">#&gt;  [4] "/tmp/Rtmpaaycpe/temp_libpath6e24f5908f2/ctwas/extdata/example_genotype_files/example_chr4.pgen" </span>
<span class="co">#&gt;  [5] "/tmp/Rtmpaaycpe/temp_libpath6e24f5908f2/ctwas/extdata/example_genotype_files/example_chr5.pgen" </span>
<span class="co">#&gt;  [6] "/tmp/Rtmpaaycpe/temp_libpath6e24f5908f2/ctwas/extdata/example_genotype_files/example_chr6.pgen" </span>
<span class="co">#&gt;  [7] "/tmp/Rtmpaaycpe/temp_libpath6e24f5908f2/ctwas/extdata/example_genotype_files/example_chr7.pgen" </span>
<span class="co">#&gt;  [8] "/tmp/Rtmpaaycpe/temp_libpath6e24f5908f2/ctwas/extdata/example_genotype_files/example_chr8.pgen" </span>
<span class="co">#&gt;  [9] "/tmp/Rtmpaaycpe/temp_libpath6e24f5908f2/ctwas/extdata/example_genotype_files/example_chr9.pgen" </span>
<span class="co">#&gt; [10] "/tmp/Rtmpaaycpe/temp_libpath6e24f5908f2/ctwas/extdata/example_genotype_files/example_chr10.pgen"</span>
<span class="co">#&gt; [11] "/tmp/Rtmpaaycpe/temp_libpath6e24f5908f2/ctwas/extdata/example_genotype_files/example_chr11.pgen"</span>
<span class="co">#&gt; [12] "/tmp/Rtmpaaycpe/temp_libpath6e24f5908f2/ctwas/extdata/example_genotype_files/example_chr12.pgen"</span>
<span class="co">#&gt; [13] "/tmp/Rtmpaaycpe/temp_libpath6e24f5908f2/ctwas/extdata/example_genotype_files/example_chr13.pgen"</span>
<span class="co">#&gt; [14] "/tmp/Rtmpaaycpe/temp_libpath6e24f5908f2/ctwas/extdata/example_genotype_files/example_chr14.pgen"</span>
<span class="co">#&gt; [15] "/tmp/Rtmpaaycpe/temp_libpath6e24f5908f2/ctwas/extdata/example_genotype_files/example_chr15.pgen"</span>
<span class="co">#&gt; [16] "/tmp/Rtmpaaycpe/temp_libpath6e24f5908f2/ctwas/extdata/example_genotype_files/example_chr16.pgen"</span>
<span class="co">#&gt; [17] "/tmp/Rtmpaaycpe/temp_libpath6e24f5908f2/ctwas/extdata/example_genotype_files/example_chr17.pgen"</span>
<span class="co">#&gt; [18] "/tmp/Rtmpaaycpe/temp_libpath6e24f5908f2/ctwas/extdata/example_genotype_files/example_chr18.pgen"</span>
<span class="co">#&gt; [19] "/tmp/Rtmpaaycpe/temp_libpath6e24f5908f2/ctwas/extdata/example_genotype_files/example_chr19.pgen"</span>
<span class="co">#&gt; [20] "/tmp/Rtmpaaycpe/temp_libpath6e24f5908f2/ctwas/extdata/example_genotype_files/example_chr20.pgen"</span>
<span class="co">#&gt; [21] "/tmp/Rtmpaaycpe/temp_libpath6e24f5908f2/ctwas/extdata/example_genotype_files/example_chr21.pgen"</span>
<span class="co">#&gt; [22] "/tmp/Rtmpaaycpe/temp_libpath6e24f5908f2/ctwas/extdata/example_genotype_files/example_chr22.pgen"</span></code></pre></div>
<p><strong>Or if you want to provide R matrices</strong> , you need to provide a directory with all <code>.RDS</code> and matching <code>.Rvar</code> files. For example:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ld_R_dir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"extdata/example_ld_R"</span>, package <span class="op">=</span> <span class="st">"ctwas"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/list.files.html">list.files</a></span><span class="op">(</span><span class="va">ld_R_dir</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span>
<span class="co">#&gt;  [1] "example_chr1.R_snp.0_5.RDS"      "example_chr1.R_snp.0_5.Rvar"    </span>
<span class="co">#&gt;  [3] "example_chr1.R_snp.125_155.RDS"  "example_chr1.R_snp.125_155.Rvar"</span>
<span class="co">#&gt;  [5] "example_chr1.R_snp.155_185.RDS"  "example_chr1.R_snp.155_185.Rvar"</span>
<span class="co">#&gt;  [7] "example_chr1.R_snp.185_215.RDS"  "example_chr1.R_snp.185_215.Rvar"</span>
<span class="co">#&gt;  [9] "example_chr1.R_snp.215_245.RDS"  "example_chr1.R_snp.215_245.Rvar"</span></code></pre></div>
<p>The .RDS file, is a <a href="https://www.rdocumentation.org/packages/base/versions/3.3.2/topics/readRDS?tap_a=5644-dce66f&amp;tap_s=10907-287229">R .RDS format</a> file. It stores the LD correlation matrix for a region (a <span class="math inline">\(p \times p\)</span> matrix, <span class="math inline">\(p\)</span> is the number of SNPs in the region). We also require that for each <code>.RDS</code> file, a file with the same stem name but ended with the suffix <code>.Rvar</code> to present in the same directory. This .Rvar files gives SNPs information in the region and its order should match columns/rows in the <code>.RDS</code> file. An example, if the .RDS file is <code>example_chr1.R_snp.0_5.RDS</code>. the matching <code>.Rvar</code> file should be <code>example_chr1.R_snp.0_5.Rvar</code> in the same directory, and it looks like this:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"extdata/example_ld_R"</span>,<span class="st">"example_chr1.R_snp.0_5.Rvar"</span>,  package <span class="op">=</span> <span class="st">"ctwas"</span><span class="op">)</span>, header <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;   chrom     id pos alt ref</span>
<span class="co">#&gt; 1     1 rs1001   1   G   A</span>
<span class="co">#&gt; 2     1 rs1002   2   C   T</span>
<span class="co">#&gt; 3     1 rs1003   3   G   A</span>
<span class="co">#&gt; 4     1 rs1004   4   C   T</span></code></pre></div>
<p>The program will automatically search for all <code>.RDS</code> and <code>.Rvar</code> file in the directory, so no other <code>.RDS</code> files should be seen in this directory unless you want to use it as a LD R matrix in the program. Each SNP should uniquely belong to one of these R matrices.</p>
<p>Note: LD reference should contain as many GWAS SNPs as possible as only the overlapping SNPs are included in the analysis. Also only SNPs with z scores, in LD reference and are eQTLs (i.e. SNPs shared in GWAS, LD reference and weight files) are used in imputing gene expression z scores. Thus we suggest you to impute z scores for eQTLs if many are not available. The program will harmonize data internally. All coordinates are in hg19.</p>
<ul>
<li>Weight files. Please check out <a href="http://gusevlab.org/projects/fusion/#computing-your-own-functional-weights">Fusion/TWAS</a> for the format of weights. Below is an example.</li>
</ul>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># weight</span>
<span class="va">weight</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"extdata/example_fusion_weights"</span>, <span class="st">"Tissue"</span>, package <span class="op">=</span> <span class="st">"ctwas"</span><span class="op">)</span></code></pre></div>
<ul>
<li>Regions file (Optional).</li>
</ul>
<p>If you want to use your own regions file, please provide a file like this:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">regionsfile</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"example_regions.bed"</span>, package <span class="op">=</span> <span class="st">"ctwas"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span><span class="op">(</span><span class="va">regionsfile</span>, header <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;   chr start stop</span>
<span class="co">#&gt; 1   1     0    5</span>
<span class="co">#&gt; 2   1     5   35</span>
<span class="co">#&gt; 3   1    35   65</span>
<span class="co">#&gt; 4   1    65   95</span>
<span class="co">#&gt; 5   1    95  125</span>
<span class="co">#&gt; 6   1   125  155</span></code></pre></div>
<p>The regions are left closed and right open, i.g. [start, stop).</p>
<p>Otherwise, the package provided regions files generated by ldetect. You can specify the population that matches your GWAS data in <code>ctwas_rss</code> function. See below.</p>
</div>
<div id="steps-when-using-ld-genotype-data" class="section level1">
<h1 class="hasAnchor">
<a href="#steps-when-using-ld-genotype-data" class="anchor"></a>Steps when using LD genotype data</h1>
<div id="step-1-impute-expression-z-scores" class="section level2">
<h2 class="hasAnchor">
<a href="#step-1-impute-expression-z-scores" class="anchor"></a>Step 1: impute expression z scores</h2>
<p>In the following code, we compute expression z scores for each gene. We do this chromosome by chromosome. <code>impute_expr_z</code> will return z scores for each gene. It will also generate files containing the reference LD genotypes for eQTLs in the gene and the filename is returned. We will need these files in the <code>ctwas_rss</code> function in step 2.</p>
<p>When providing LD genotype data:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">outputdir</span> <span class="op">&lt;-</span> <span class="st">"~/temp"</span>
<span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/impute_expr_z.html">impute_expr_z</a></span><span class="op">(</span>z_snp <span class="op">=</span> <span class="va">z_snp</span>,  weight <span class="op">=</span> <span class="va">weight</span>, ld_pgenfs <span class="op">=</span> <span class="va">ld_pgenfs</span>,
                           method <span class="op">=</span> <span class="st">"lasso"</span>, outputdir <span class="op">=</span> <span class="va">outputdir</span>,
                           outname <span class="op">=</span> <span class="st">"test_ss"</span><span class="op">)</span>
<span class="co">#&gt; 2021-06-03 09:12:37 INFO::flipping z scores to match LD reference</span>
<span class="co">#&gt; 2021-06-03 09:12:37 INFO::will also flip weights to match LD reference for each gene</span>
<span class="co">#&gt; 2021-06-03 09:12:37 INFO::number of genes with weights provided: 20</span>
<span class="co">#&gt; 2021-06-03 09:12:37 INFO::number of genes on chromosome 1: 1</span>
<span class="co">#&gt; 2021-06-03 09:12:37 INFO::collecting gene weight information ...</span>
<span class="co">#&gt; 2021-06-03 09:12:37 INFO::Start gene z score imputation ...</span>
<span class="co">#&gt; 2021-06-03 09:12:37 INFO::ld genotype is given, using genotypes to impute gene z score.</span>
<span class="co">#&gt; 2021-06-03 09:12:37 INFO::Imputation done, writing results to output...</span>
<span class="co">#&gt; 2021-06-03 09:12:37 INFO::Imputation done: number of genes with imputed expression: 1 for chr 1</span>
<span class="co">#&gt; 2021-06-03 09:12:37 INFO::flipping z scores to match LD reference</span>
<span class="co">#&gt; 2021-06-03 09:12:37 INFO::will also flip weights to match LD reference for each gene</span>
<span class="co">#&gt; 2021-06-03 09:12:37 INFO::number of genes with weights provided: 20</span>
<span class="co">#&gt; 2021-06-03 09:12:37 INFO::number of genes on chromosome 2: 1</span>
<span class="co">#&gt; 2021-06-03 09:12:37 INFO::collecting gene weight information ...</span>
<span class="co">#&gt; 2021-06-03 09:12:37 INFO::Start gene z score imputation ...</span>
<span class="co">#&gt; 2021-06-03 09:12:37 INFO::ld genotype is given, using genotypes to impute gene z score.</span>
<span class="co">#&gt; 2021-06-03 09:12:37 INFO::Imputation done, writing results to output...</span>
<span class="co">#&gt; 2021-06-03 09:12:37 INFO::Imputation done: number of genes with imputed expression: 1 for chr 2</span>
<span class="co">#&gt; 2021-06-03 09:12:37 INFO::flipping z scores to match LD reference</span>
<span class="co">#&gt; 2021-06-03 09:12:37 INFO::will also flip weights to match LD reference for each gene</span>
<span class="co">#&gt; 2021-06-03 09:12:37 INFO::number of genes with weights provided: 20</span>
<span class="co">#&gt; 2021-06-03 09:12:37 INFO::number of genes on chromosome 3: 1</span>
<span class="co">#&gt; 2021-06-03 09:12:37 INFO::collecting gene weight information ...</span>
<span class="co">#&gt; 2021-06-03 09:12:37 INFO::Start gene z score imputation ...</span>
<span class="co">#&gt; 2021-06-03 09:12:37 INFO::ld genotype is given, using genotypes to impute gene z score.</span>
<span class="co">#&gt; 2021-06-03 09:12:37 INFO::Imputation done, writing results to output...</span>
<span class="co">#&gt; 2021-06-03 09:12:37 INFO::Imputation done: number of genes with imputed expression: 1 for chr 3</span>
<span class="co">#&gt; 2021-06-03 09:12:37 INFO::flipping z scores to match LD reference</span>
<span class="co">#&gt; 2021-06-03 09:12:37 INFO::will also flip weights to match LD reference for each gene</span>
<span class="co">#&gt; 2021-06-03 09:12:37 INFO::number of genes with weights provided: 20</span>
<span class="co">#&gt; 2021-06-03 09:12:37 INFO::number of genes on chromosome 4: 1</span>
<span class="co">#&gt; 2021-06-03 09:12:37 INFO::collecting gene weight information ...</span>
<span class="co">#&gt; 2021-06-03 09:12:37 INFO::Start gene z score imputation ...</span>
<span class="co">#&gt; 2021-06-03 09:12:37 INFO::ld genotype is given, using genotypes to impute gene z score.</span>
<span class="co">#&gt; 2021-06-03 09:12:37 INFO::Imputation done, writing results to output...</span>
<span class="co">#&gt; 2021-06-03 09:12:37 INFO::Imputation done: number of genes with imputed expression: 1 for chr 4</span>
<span class="co">#&gt; 2021-06-03 09:12:37 INFO::flipping z scores to match LD reference</span>
<span class="co">#&gt; 2021-06-03 09:12:37 INFO::will also flip weights to match LD reference for each gene</span>
<span class="co">#&gt; 2021-06-03 09:12:37 INFO::number of genes with weights provided: 20</span>
<span class="co">#&gt; 2021-06-03 09:12:37 INFO::number of genes on chromosome 5: 1</span>
<span class="co">#&gt; 2021-06-03 09:12:37 INFO::collecting gene weight information ...</span>
<span class="co">#&gt; 2021-06-03 09:12:37 INFO::Start gene z score imputation ...</span>
<span class="co">#&gt; 2021-06-03 09:12:37 INFO::ld genotype is given, using genotypes to impute gene z score.</span>
<span class="co">#&gt; 2021-06-03 09:12:37 INFO::Imputation done, writing results to output...</span>
<span class="co">#&gt; 2021-06-03 09:12:37 INFO::Imputation done: number of genes with imputed expression: 1 for chr 5</span>
<span class="co">#&gt; 2021-06-03 09:12:37 INFO::flipping z scores to match LD reference</span>
<span class="co">#&gt; 2021-06-03 09:12:37 INFO::will also flip weights to match LD reference for each gene</span>
<span class="co">#&gt; 2021-06-03 09:12:37 INFO::number of genes with weights provided: 20</span>
<span class="co">#&gt; 2021-06-03 09:12:37 INFO::number of genes on chromosome 6: 1</span>
<span class="co">#&gt; 2021-06-03 09:12:37 INFO::collecting gene weight information ...</span>
<span class="co">#&gt; 2021-06-03 09:12:37 INFO::Start gene z score imputation ...</span>
<span class="co">#&gt; 2021-06-03 09:12:37 INFO::ld genotype is given, using genotypes to impute gene z score.</span>
<span class="co">#&gt; 2021-06-03 09:12:37 INFO::Imputation done, writing results to output...</span>
<span class="co">#&gt; 2021-06-03 09:12:37 INFO::Imputation done: number of genes with imputed expression: 1 for chr 6</span>
<span class="co">#&gt; 2021-06-03 09:12:38 INFO::flipping z scores to match LD reference</span>
<span class="co">#&gt; 2021-06-03 09:12:38 INFO::will also flip weights to match LD reference for each gene</span>
<span class="co">#&gt; 2021-06-03 09:12:38 INFO::number of genes with weights provided: 20</span>
<span class="co">#&gt; 2021-06-03 09:12:38 INFO::number of genes on chromosome 7: 1</span>
<span class="co">#&gt; 2021-06-03 09:12:38 INFO::collecting gene weight information ...</span>
<span class="co">#&gt; 2021-06-03 09:12:38 INFO::Start gene z score imputation ...</span>
<span class="co">#&gt; 2021-06-03 09:12:38 INFO::ld genotype is given, using genotypes to impute gene z score.</span>
<span class="co">#&gt; 2021-06-03 09:12:38 INFO::Imputation done, writing results to output...</span>
<span class="co">#&gt; 2021-06-03 09:12:38 INFO::Imputation done: number of genes with imputed expression: 1 for chr 7</span>
<span class="co">#&gt; 2021-06-03 09:12:38 INFO::flipping z scores to match LD reference</span>
<span class="co">#&gt; 2021-06-03 09:12:38 INFO::will also flip weights to match LD reference for each gene</span>
<span class="co">#&gt; 2021-06-03 09:12:38 INFO::number of genes with weights provided: 20</span>
<span class="co">#&gt; 2021-06-03 09:12:38 INFO::number of genes on chromosome 8: 1</span>
<span class="co">#&gt; 2021-06-03 09:12:38 INFO::collecting gene weight information ...</span>
<span class="co">#&gt; 2021-06-03 09:12:38 INFO::Start gene z score imputation ...</span>
<span class="co">#&gt; 2021-06-03 09:12:38 INFO::ld genotype is given, using genotypes to impute gene z score.</span>
<span class="co">#&gt; 2021-06-03 09:12:38 INFO::Imputation done, writing results to output...</span>
<span class="co">#&gt; 2021-06-03 09:12:38 INFO::Imputation done: number of genes with imputed expression: 1 for chr 8</span>
<span class="co">#&gt; 2021-06-03 09:12:38 INFO::flipping z scores to match LD reference</span>
<span class="co">#&gt; 2021-06-03 09:12:38 INFO::will also flip weights to match LD reference for each gene</span>
<span class="co">#&gt; 2021-06-03 09:12:38 INFO::number of genes with weights provided: 20</span>
<span class="co">#&gt; 2021-06-03 09:12:38 INFO::number of genes on chromosome 9: 1</span>
<span class="co">#&gt; 2021-06-03 09:12:38 INFO::collecting gene weight information ...</span>
<span class="co">#&gt; 2021-06-03 09:12:38 INFO::Start gene z score imputation ...</span>
<span class="co">#&gt; 2021-06-03 09:12:38 INFO::ld genotype is given, using genotypes to impute gene z score.</span>
<span class="co">#&gt; 2021-06-03 09:12:38 INFO::Imputation done, writing results to output...</span>
<span class="co">#&gt; 2021-06-03 09:12:38 INFO::Imputation done: number of genes with imputed expression: 1 for chr 9</span>
<span class="co">#&gt; 2021-06-03 09:12:38 INFO::flipping z scores to match LD reference</span>
<span class="co">#&gt; 2021-06-03 09:12:38 INFO::will also flip weights to match LD reference for each gene</span>
<span class="co">#&gt; 2021-06-03 09:12:38 INFO::number of genes with weights provided: 20</span>
<span class="co">#&gt; 2021-06-03 09:12:38 INFO::number of genes on chromosome 10: 1</span>
<span class="co">#&gt; 2021-06-03 09:12:38 INFO::collecting gene weight information ...</span>
<span class="co">#&gt; 2021-06-03 09:12:38 INFO::Start gene z score imputation ...</span>
<span class="co">#&gt; 2021-06-03 09:12:38 INFO::ld genotype is given, using genotypes to impute gene z score.</span>
<span class="co">#&gt; 2021-06-03 09:12:38 INFO::Imputation done, writing results to output...</span>
<span class="co">#&gt; 2021-06-03 09:12:38 INFO::Imputation done: number of genes with imputed expression: 1 for chr 10</span>
<span class="co">#&gt; 2021-06-03 09:12:38 INFO::flipping z scores to match LD reference</span>
<span class="co">#&gt; 2021-06-03 09:12:38 INFO::will also flip weights to match LD reference for each gene</span>
<span class="co">#&gt; 2021-06-03 09:12:38 INFO::number of genes with weights provided: 20</span>
<span class="co">#&gt; 2021-06-03 09:12:38 INFO::number of genes on chromosome 11: 1</span>
<span class="co">#&gt; 2021-06-03 09:12:38 INFO::collecting gene weight information ...</span>
<span class="co">#&gt; 2021-06-03 09:12:38 INFO::Start gene z score imputation ...</span>
<span class="co">#&gt; 2021-06-03 09:12:38 INFO::ld genotype is given, using genotypes to impute gene z score.</span>
<span class="co">#&gt; 2021-06-03 09:12:38 INFO::Imputation done, writing results to output...</span>
<span class="co">#&gt; 2021-06-03 09:12:38 INFO::Imputation done: number of genes with imputed expression: 1 for chr 11</span>
<span class="co">#&gt; 2021-06-03 09:12:38 INFO::flipping z scores to match LD reference</span>
<span class="co">#&gt; 2021-06-03 09:12:38 INFO::will also flip weights to match LD reference for each gene</span>
<span class="co">#&gt; 2021-06-03 09:12:38 INFO::number of genes with weights provided: 20</span>
<span class="co">#&gt; 2021-06-03 09:12:38 INFO::number of genes on chromosome 12: 1</span>
<span class="co">#&gt; 2021-06-03 09:12:38 INFO::collecting gene weight information ...</span>
<span class="co">#&gt; 2021-06-03 09:12:38 INFO::Start gene z score imputation ...</span>
<span class="co">#&gt; 2021-06-03 09:12:38 INFO::ld genotype is given, using genotypes to impute gene z score.</span>
<span class="co">#&gt; 2021-06-03 09:12:38 INFO::Imputation done, writing results to output...</span>
<span class="co">#&gt; 2021-06-03 09:12:38 INFO::Imputation done: number of genes with imputed expression: 1 for chr 12</span>
<span class="co">#&gt; 2021-06-03 09:12:38 INFO::flipping z scores to match LD reference</span>
<span class="co">#&gt; 2021-06-03 09:12:38 INFO::will also flip weights to match LD reference for each gene</span>
<span class="co">#&gt; 2021-06-03 09:12:38 INFO::number of genes with weights provided: 20</span>
<span class="co">#&gt; 2021-06-03 09:12:38 INFO::number of genes on chromosome 13: 1</span>
<span class="co">#&gt; 2021-06-03 09:12:38 INFO::collecting gene weight information ...</span>
<span class="co">#&gt; 2021-06-03 09:12:38 INFO::Start gene z score imputation ...</span>
<span class="co">#&gt; 2021-06-03 09:12:38 INFO::ld genotype is given, using genotypes to impute gene z score.</span>
<span class="co">#&gt; 2021-06-03 09:12:38 INFO::Imputation done, writing results to output...</span>
<span class="co">#&gt; 2021-06-03 09:12:38 INFO::Imputation done: number of genes with imputed expression: 1 for chr 13</span>
<span class="co">#&gt; 2021-06-03 09:12:38 INFO::flipping z scores to match LD reference</span>
<span class="co">#&gt; 2021-06-03 09:12:38 INFO::will also flip weights to match LD reference for each gene</span>
<span class="co">#&gt; 2021-06-03 09:12:38 INFO::number of genes with weights provided: 20</span>
<span class="co">#&gt; 2021-06-03 09:12:38 INFO::number of genes on chromosome 14: 1</span>
<span class="co">#&gt; 2021-06-03 09:12:38 INFO::collecting gene weight information ...</span>
<span class="co">#&gt; 2021-06-03 09:12:38 INFO::Start gene z score imputation ...</span>
<span class="co">#&gt; 2021-06-03 09:12:38 INFO::ld genotype is given, using genotypes to impute gene z score.</span>
<span class="co">#&gt; 2021-06-03 09:12:38 INFO::Imputation done, writing results to output...</span>
<span class="co">#&gt; 2021-06-03 09:12:38 INFO::Imputation done: number of genes with imputed expression: 1 for chr 14</span>
<span class="co">#&gt; 2021-06-03 09:12:38 INFO::flipping z scores to match LD reference</span>
<span class="co">#&gt; 2021-06-03 09:12:38 INFO::will also flip weights to match LD reference for each gene</span>
<span class="co">#&gt; 2021-06-03 09:12:38 INFO::number of genes with weights provided: 20</span>
<span class="co">#&gt; 2021-06-03 09:12:38 INFO::number of genes on chromosome 15: 1</span>
<span class="co">#&gt; 2021-06-03 09:12:38 INFO::collecting gene weight information ...</span>
<span class="co">#&gt; 2021-06-03 09:12:38 INFO::Start gene z score imputation ...</span>
<span class="co">#&gt; 2021-06-03 09:12:38 INFO::ld genotype is given, using genotypes to impute gene z score.</span>
<span class="co">#&gt; 2021-06-03 09:12:38 INFO::Imputation done, writing results to output...</span>
<span class="co">#&gt; 2021-06-03 09:12:38 INFO::Imputation done: number of genes with imputed expression: 1 for chr 15</span>
<span class="co">#&gt; 2021-06-03 09:12:38 INFO::flipping z scores to match LD reference</span>
<span class="co">#&gt; 2021-06-03 09:12:38 INFO::will also flip weights to match LD reference for each gene</span>
<span class="co">#&gt; 2021-06-03 09:12:38 INFO::number of genes with weights provided: 20</span>
<span class="co">#&gt; 2021-06-03 09:12:38 INFO::number of genes on chromosome 16: 1</span>
<span class="co">#&gt; 2021-06-03 09:12:38 INFO::collecting gene weight information ...</span>
<span class="co">#&gt; 2021-06-03 09:12:38 INFO::Start gene z score imputation ...</span>
<span class="co">#&gt; 2021-06-03 09:12:38 INFO::ld genotype is given, using genotypes to impute gene z score.</span>
<span class="co">#&gt; 2021-06-03 09:12:38 INFO::Imputation done, writing results to output...</span>
<span class="co">#&gt; 2021-06-03 09:12:38 INFO::Imputation done: number of genes with imputed expression: 1 for chr 16</span>
<span class="co">#&gt; 2021-06-03 09:12:38 INFO::flipping z scores to match LD reference</span>
<span class="co">#&gt; 2021-06-03 09:12:38 INFO::will also flip weights to match LD reference for each gene</span>
<span class="co">#&gt; 2021-06-03 09:12:38 INFO::number of genes with weights provided: 20</span>
<span class="co">#&gt; 2021-06-03 09:12:38 INFO::number of genes on chromosome 17: 1</span>
<span class="co">#&gt; 2021-06-03 09:12:38 INFO::collecting gene weight information ...</span>
<span class="co">#&gt; 2021-06-03 09:12:38 INFO::Start gene z score imputation ...</span>
<span class="co">#&gt; 2021-06-03 09:12:38 INFO::ld genotype is given, using genotypes to impute gene z score.</span>
<span class="co">#&gt; 2021-06-03 09:12:38 INFO::Imputation done, writing results to output...</span>
<span class="co">#&gt; 2021-06-03 09:12:38 INFO::Imputation done: number of genes with imputed expression: 1 for chr 17</span>
<span class="co">#&gt; 2021-06-03 09:12:38 INFO::flipping z scores to match LD reference</span>
<span class="co">#&gt; 2021-06-03 09:12:38 INFO::will also flip weights to match LD reference for each gene</span>
<span class="co">#&gt; 2021-06-03 09:12:38 INFO::number of genes with weights provided: 20</span>
<span class="co">#&gt; 2021-06-03 09:12:38 INFO::number of genes on chromosome 18: 1</span>
<span class="co">#&gt; 2021-06-03 09:12:38 INFO::collecting gene weight information ...</span>
<span class="co">#&gt; 2021-06-03 09:12:38 INFO::Start gene z score imputation ...</span>
<span class="co">#&gt; 2021-06-03 09:12:38 INFO::ld genotype is given, using genotypes to impute gene z score.</span>
<span class="co">#&gt; 2021-06-03 09:12:38 INFO::Imputation done, writing results to output...</span>
<span class="co">#&gt; 2021-06-03 09:12:39 INFO::Imputation done: number of genes with imputed expression: 1 for chr 18</span>
<span class="co">#&gt; 2021-06-03 09:12:39 INFO::flipping z scores to match LD reference</span>
<span class="co">#&gt; 2021-06-03 09:12:39 INFO::will also flip weights to match LD reference for each gene</span>
<span class="co">#&gt; 2021-06-03 09:12:39 INFO::number of genes with weights provided: 20</span>
<span class="co">#&gt; 2021-06-03 09:12:39 INFO::number of genes on chromosome 19: 1</span>
<span class="co">#&gt; 2021-06-03 09:12:39 INFO::collecting gene weight information ...</span>
<span class="co">#&gt; 2021-06-03 09:12:39 INFO::Start gene z score imputation ...</span>
<span class="co">#&gt; 2021-06-03 09:12:39 INFO::ld genotype is given, using genotypes to impute gene z score.</span>
<span class="co">#&gt; 2021-06-03 09:12:39 INFO::Imputation done, writing results to output...</span>
<span class="co">#&gt; 2021-06-03 09:12:39 INFO::Imputation done: number of genes with imputed expression: 1 for chr 19</span>
<span class="co">#&gt; 2021-06-03 09:12:39 INFO::flipping z scores to match LD reference</span>
<span class="co">#&gt; 2021-06-03 09:12:39 INFO::will also flip weights to match LD reference for each gene</span>
<span class="co">#&gt; 2021-06-03 09:12:39 INFO::number of genes with weights provided: 20</span>
<span class="co">#&gt; 2021-06-03 09:12:39 INFO::number of genes on chromosome 20: 1</span>
<span class="co">#&gt; 2021-06-03 09:12:39 INFO::collecting gene weight information ...</span>
<span class="co">#&gt; 2021-06-03 09:12:39 INFO::Start gene z score imputation ...</span>
<span class="co">#&gt; 2021-06-03 09:12:39 INFO::ld genotype is given, using genotypes to impute gene z score.</span>
<span class="co">#&gt; 2021-06-03 09:12:39 INFO::Imputation done, writing results to output...</span>
<span class="co">#&gt; 2021-06-03 09:12:39 INFO::Imputation done: number of genes with imputed expression: 1 for chr 20</span>
<span class="co">#&gt; 2021-06-03 09:12:39 INFO::flipping z scores to match LD reference</span>
<span class="co">#&gt; 2021-06-03 09:12:39 INFO::will also flip weights to match LD reference for each gene</span>
<span class="co">#&gt; 2021-06-03 09:12:39 INFO::number of genes with weights provided: 20</span>
<span class="co">#&gt; 2021-06-03 09:12:39 INFO::number of genes on chromosome 21: 0</span>
<span class="co">#&gt; 2021-06-03 09:12:39 INFO::collecting gene weight information ...</span>
<span class="co">#&gt; 2021-06-03 09:12:39 INFO::Imputation done, writing results to output...</span>
<span class="co">#&gt; 2021-06-03 09:12:39 INFO::Imputation done: number of genes with imputed expression: 0 for chr 21</span>
<span class="co">#&gt; 2021-06-03 09:12:39 INFO::flipping z scores to match LD reference</span>
<span class="co">#&gt; 2021-06-03 09:12:39 INFO::will also flip weights to match LD reference for each gene</span>
<span class="co">#&gt; 2021-06-03 09:12:39 INFO::number of genes with weights provided: 20</span>
<span class="co">#&gt; 2021-06-03 09:12:39 INFO::number of genes on chromosome 22: 0</span>
<span class="co">#&gt; 2021-06-03 09:12:39 INFO::collecting gene weight information ...</span>
<span class="co">#&gt; 2021-06-03 09:12:39 INFO::Imputation done, writing results to output...</span>
<span class="co">#&gt; 2021-06-03 09:12:39 INFO::Imputation done: number of genes with imputed expression: 0 for chr 22</span>
<span class="va">z_gene</span> <span class="op">&lt;-</span> <span class="va">res</span><span class="op">$</span><span class="va">z_gene</span>
<span class="va">ld_exprfs</span> <span class="op">&lt;-</span> <span class="va">res</span><span class="op">$</span><span class="va">ld_exprfs</span>

<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">z_gene</span><span class="op">)</span>
<span class="co">#&gt;          id          z</span>
<span class="co">#&gt; gene1 gene1 18.4624001</span>
<span class="co">#&gt; gene2 gene2 -1.7169590</span>
<span class="co">#&gt; gene3 gene3 -0.4940096</span>
<span class="co">#&gt; gene4 gene4 -0.5448988</span>
<span class="co">#&gt; gene5 gene5 -0.1813120</span>
<span class="co">#&gt; gene6 gene6 -0.2698443</span>
<span class="va">ld_exprfs</span>
<span class="co">#&gt;  [1] "~/temp/test_ss_chr1.expr.gz"  "~/temp/test_ss_chr2.expr.gz" </span>
<span class="co">#&gt;  [3] "~/temp/test_ss_chr3.expr.gz"  "~/temp/test_ss_chr4.expr.gz" </span>
<span class="co">#&gt;  [5] "~/temp/test_ss_chr5.expr.gz"  "~/temp/test_ss_chr6.expr.gz" </span>
<span class="co">#&gt;  [7] "~/temp/test_ss_chr7.expr.gz"  "~/temp/test_ss_chr8.expr.gz" </span>
<span class="co">#&gt;  [9] "~/temp/test_ss_chr9.expr.gz"  "~/temp/test_ss_chr10.expr.gz"</span>
<span class="co">#&gt; [11] "~/temp/test_ss_chr11.expr.gz" "~/temp/test_ss_chr12.expr.gz"</span>
<span class="co">#&gt; [13] "~/temp/test_ss_chr13.expr.gz" "~/temp/test_ss_chr14.expr.gz"</span>
<span class="co">#&gt; [15] "~/temp/test_ss_chr15.expr.gz" "~/temp/test_ss_chr16.expr.gz"</span>
<span class="co">#&gt; [17] "~/temp/test_ss_chr17.expr.gz" "~/temp/test_ss_chr18.expr.gz"</span>
<span class="co">#&gt; [19] "~/temp/test_ss_chr19.expr.gz" "~/temp/test_ss_chr20.expr.gz"</span>
<span class="co">#&gt; [21] "~/temp/test_ss_chr21.expr.gz" "~/temp/test_ss_chr22.expr.gz"</span></code></pre></div>
</div>
<div id="step-2-run-ctwas_rss-" class="section level2">
<h2 class="hasAnchor">
<a href="#step-2-run-ctwas_rss-" class="anchor"></a>Step 2: run <code>ctwas_rss</code>.</h2>
<p>In this step we will perform the causal TWAS algorithm, the algorithm will run susie iteratively for parameter estimation and lastly provide PIPs for all genes and SNPs included in the analysis. If you don’t want to define your own LD regions, then you can use the one defined by ldetect by simply specifying the population name using the <code>ld_regions</code> argument. One feature of the ctwas function is that it allows parallel computing. you can specify number of cores to use by the <code>ncore</code> argument.</p>
<p>Run <code>ctwas_rss</code> using genotype data for LD:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pars</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ctwas_rss.html">ctwas_rss</a></span><span class="op">(</span>z_gene <span class="op">=</span> <span class="va">z_gene</span>, z_snp <span class="op">=</span> <span class="va">z_snp</span>, ld_exprfs <span class="op">=</span> <span class="va">ld_exprfs</span>, ld_pgenfs <span class="op">=</span> <span class="va">ld_pgenfs</span>, ld_regions_custom <span class="op">=</span> <span class="va">regionsfile</span>, thin <span class="op">=</span> <span class="fl">0.9</span>, max_snp_region <span class="op">=</span> <span class="fl">20</span>, outputdir <span class="op">=</span> <span class="va">outputdir</span>, outname <span class="op">=</span> <span class="st">"test_ss"</span>, ncore <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>
<span class="co">#&gt; 2021-06-03 09:12:39 INFO::ctwas started ...</span>
<span class="co">#&gt; 2021-06-03 09:12:39 INFO::LD region file: /tmp/Rtmpaaycpe/temp_libpath6e24f5908f2/ctwas/extdata/example_regions.bed</span>
<span class="co">#&gt; 2021-06-03 09:12:39 INFO::flipping z scores to match LD reference</span>
<span class="co">#&gt; 2021-06-03 09:12:39 INFO::No. LD regions: 374</span>
<span class="co">#&gt; 2021-06-03 09:12:39 INFO::No. regions with at least one SNP/gene for chr1: 17</span>
<span class="co">#&gt; 2021-06-03 09:12:39 INFO::Merge regions for chr1</span>
<span class="co">#&gt; 2021-06-03 09:12:39 INFO::No. regions with at least one SNP/gene for chr1 after merging: 17</span>
<span class="co">#&gt; 2021-06-03 09:12:39 INFO::No. regions with at least one SNP/gene for chr2: 17</span>
<span class="co">#&gt; 2021-06-03 09:12:39 INFO::Merge regions for chr2</span>
<span class="co">#&gt; 2021-06-03 09:12:39 INFO::No. regions with at least one SNP/gene for chr2 after merging: 17</span>
<span class="co">#&gt; 2021-06-03 09:12:39 INFO::No. regions with at least one SNP/gene for chr3: 17</span>
<span class="co">#&gt; 2021-06-03 09:12:39 INFO::Merge regions for chr3</span>
<span class="co">#&gt; 2021-06-03 09:12:39 INFO::No. regions with at least one SNP/gene for chr3 after merging: 17</span>
<span class="co">#&gt; 2021-06-03 09:12:39 INFO::No. regions with at least one SNP/gene for chr4: 17</span>
<span class="co">#&gt; 2021-06-03 09:12:39 INFO::Merge regions for chr4</span>
<span class="co">#&gt; 2021-06-03 09:12:39 INFO::No. regions with at least one SNP/gene for chr4 after merging: 16</span>
<span class="co">#&gt; 2021-06-03 09:12:39 INFO::No. regions with at least one SNP/gene for chr5: 17</span>
<span class="co">#&gt; 2021-06-03 09:12:39 INFO::Merge regions for chr5</span>
<span class="co">#&gt; 2021-06-03 09:12:39 INFO::No. regions with at least one SNP/gene for chr5 after merging: 17</span>
<span class="co">#&gt; 2021-06-03 09:12:39 INFO::No. regions with at least one SNP/gene for chr6: 17</span>
<span class="co">#&gt; 2021-06-03 09:12:39 INFO::Merge regions for chr6</span>
<span class="co">#&gt; 2021-06-03 09:12:39 INFO::No. regions with at least one SNP/gene for chr6 after merging: 17</span>
<span class="co">#&gt; 2021-06-03 09:12:40 INFO::No. regions with at least one SNP/gene for chr7: 17</span>
<span class="co">#&gt; 2021-06-03 09:12:40 INFO::Merge regions for chr7</span>
<span class="co">#&gt; 2021-06-03 09:12:40 INFO::No. regions with at least one SNP/gene for chr7 after merging: 16</span>
<span class="co">#&gt; 2021-06-03 09:12:40 INFO::No. regions with at least one SNP/gene for chr8: 17</span>
<span class="co">#&gt; 2021-06-03 09:12:40 INFO::Merge regions for chr8</span>
<span class="co">#&gt; 2021-06-03 09:12:40 INFO::No. regions with at least one SNP/gene for chr8 after merging: 16</span>
<span class="co">#&gt; 2021-06-03 09:12:40 INFO::No. regions with at least one SNP/gene for chr9: 17</span>
<span class="co">#&gt; 2021-06-03 09:12:40 INFO::Merge regions for chr9</span>
<span class="co">#&gt; 2021-06-03 09:12:40 INFO::No. regions with at least one SNP/gene for chr9 after merging: 17</span>
<span class="co">#&gt; 2021-06-03 09:12:40 INFO::No. regions with at least one SNP/gene for chr10: 17</span>
<span class="co">#&gt; 2021-06-03 09:12:40 INFO::Merge regions for chr10</span>
<span class="co">#&gt; 2021-06-03 09:12:40 INFO::No. regions with at least one SNP/gene for chr10 after merging: 16</span>
<span class="co">#&gt; 2021-06-03 09:12:40 INFO::No. regions with at least one SNP/gene for chr11: 17</span>
<span class="co">#&gt; 2021-06-03 09:12:40 INFO::Merge regions for chr11</span>
<span class="co">#&gt; 2021-06-03 09:12:40 INFO::No. regions with at least one SNP/gene for chr11 after merging: 16</span>
<span class="co">#&gt; 2021-06-03 09:12:40 INFO::No. regions with at least one SNP/gene for chr12: 17</span>
<span class="co">#&gt; 2021-06-03 09:12:40 INFO::Merge regions for chr12</span>
<span class="co">#&gt; 2021-06-03 09:12:40 INFO::No. regions with at least one SNP/gene for chr12 after merging: 16</span>
<span class="co">#&gt; 2021-06-03 09:12:40 INFO::No. regions with at least one SNP/gene for chr13: 17</span>
<span class="co">#&gt; 2021-06-03 09:12:40 INFO::Merge regions for chr13</span>
<span class="co">#&gt; 2021-06-03 09:12:40 INFO::No. regions with at least one SNP/gene for chr13 after merging: 16</span>
<span class="co">#&gt; 2021-06-03 09:12:40 INFO::No. regions with at least one SNP/gene for chr14: 17</span>
<span class="co">#&gt; 2021-06-03 09:12:40 INFO::Merge regions for chr14</span>
<span class="co">#&gt; 2021-06-03 09:12:40 INFO::No. regions with at least one SNP/gene for chr14 after merging: 16</span>
<span class="co">#&gt; 2021-06-03 09:12:40 INFO::No. regions with at least one SNP/gene for chr15: 17</span>
<span class="co">#&gt; 2021-06-03 09:12:40 INFO::Merge regions for chr15</span>
<span class="co">#&gt; 2021-06-03 09:12:40 INFO::No. regions with at least one SNP/gene for chr15 after merging: 16</span>
<span class="co">#&gt; 2021-06-03 09:12:40 INFO::No. regions with at least one SNP/gene for chr16: 17</span>
<span class="co">#&gt; 2021-06-03 09:12:40 INFO::Merge regions for chr16</span>
<span class="co">#&gt; 2021-06-03 09:12:40 INFO::No. regions with at least one SNP/gene for chr16 after merging: 17</span>
<span class="co">#&gt; 2021-06-03 09:12:40 INFO::No. regions with at least one SNP/gene for chr17: 17</span>
<span class="co">#&gt; 2021-06-03 09:12:40 INFO::Merge regions for chr17</span>
<span class="co">#&gt; 2021-06-03 09:12:40 INFO::No. regions with at least one SNP/gene for chr17 after merging: 16</span>
<span class="co">#&gt; 2021-06-03 09:12:40 INFO::No. regions with at least one SNP/gene for chr18: 17</span>
<span class="co">#&gt; 2021-06-03 09:12:40 INFO::Merge regions for chr18</span>
<span class="co">#&gt; 2021-06-03 09:12:40 INFO::No. regions with at least one SNP/gene for chr18 after merging: 16</span>
<span class="co">#&gt; 2021-06-03 09:12:40 INFO::No. regions with at least one SNP/gene for chr19: 17</span>
<span class="co">#&gt; 2021-06-03 09:12:40 INFO::Merge regions for chr19</span>
<span class="co">#&gt; 2021-06-03 09:12:40 INFO::No. regions with at least one SNP/gene for chr19 after merging: 17</span>
<span class="co">#&gt; 2021-06-03 09:12:40 INFO::No. regions with at least one SNP/gene for chr20: 17</span>
<span class="co">#&gt; 2021-06-03 09:12:40 INFO::Merge regions for chr20</span>
<span class="co">#&gt; 2021-06-03 09:12:40 INFO::No. regions with at least one SNP/gene for chr20 after merging: 17</span>
<span class="co">#&gt; 2021-06-03 09:12:40 INFO::No. regions with at least one SNP/gene for chr21: 17</span>
<span class="co">#&gt; 2021-06-03 09:12:40 INFO::Merge regions for chr21</span>
<span class="co">#&gt; 2021-06-03 09:12:40 INFO::No. regions with at least one SNP/gene for chr21 after merging: 17</span>
<span class="co">#&gt; 2021-06-03 09:12:40 INFO::No. regions with at least one SNP/gene for chr22: 17</span>
<span class="co">#&gt; 2021-06-03 09:12:40 INFO::Merge regions for chr22</span>
<span class="co">#&gt; 2021-06-03 09:12:40 INFO::No. regions with at least one SNP/gene for chr22 after merging: 17</span>
<span class="co">#&gt; 2021-06-03 09:12:40 INFO::Trim regions with SNPs more than Inf</span>
<span class="co">#&gt; 2021-06-03 09:12:40 INFO::Run susie iteratively, getting rough estimate ...</span>
<span class="co">#&gt; 2021-06-03 09:12:40 INFO::run iteration 1</span>
<span class="co">#&gt; 2021-06-03 09:12:51 INFO::After iteration 1, gene prior 0.153961238288791:, SNP prior:0.0375465027367227</span>
<span class="co">#&gt; 2021-06-03 09:12:51 INFO::run iteration 2</span>
<span class="co">#&gt; 2021-06-03 09:13:01 INFO::After iteration 2, gene prior 0.0882628368144257:, SNP prior:0.036038024148467</span>
<span class="co">#&gt; 2021-06-03 09:13:01 INFO::run iteration 3</span>
<span class="co">#&gt; 2021-06-03 09:13:11 INFO::After iteration 3, gene prior 0.0666064574425768:, SNP prior:0.0353425325788066</span>
<span class="co">#&gt; 2021-06-03 09:13:11 INFO::Blocks are filtered: 16 blocks left</span>
<span class="co">#&gt; 2021-06-03 09:13:11 INFO::Run susie iteratively, getting accurate estimate ...</span>
<span class="co">#&gt; 2021-06-03 09:13:11 INFO::run iteration 1</span>
<span class="co">#&gt; 2021-06-03 09:13:14 INFO::After iteration 1, gene prior 0.120355586178647:, SNP prior:0.0313256408158837</span>
<span class="co">#&gt; 2021-06-03 09:13:14 INFO::run iteration 2</span>
<span class="co">#&gt; 2021-06-03 09:13:18 INFO::After iteration 2, gene prior 0.126671325752011:, SNP prior:0.0298158963892054</span>
<span class="co">#&gt; 2021-06-03 09:13:18 INFO::run iteration 3</span>
<span class="co">#&gt; 2021-06-03 09:13:21 INFO::After iteration 3, gene prior 0.12796885353225:, SNP prior:0.0290029393354404</span>
<span class="co">#&gt; 2021-06-03 09:13:21 INFO::run iteration 4</span>
<span class="co">#&gt; 2021-06-03 09:13:24 INFO::After iteration 4, gene prior 0.128271093620609:, SNP prior:0.0285009525352291</span>
<span class="co">#&gt; 2021-06-03 09:13:24 INFO::run iteration 5</span>
<span class="co">#&gt; 2021-06-03 09:13:27 INFO::After iteration 5, gene prior 0.128362212919623:, SNP prior:0.0281705166835132</span>
<span class="co">#&gt; 2021-06-03 09:13:27 INFO::run iteration 6</span>
<span class="co">#&gt; 2021-06-03 09:13:30 INFO::After iteration 6, gene prior 0.128404928383304:, SNP prior:0.0279473157995041</span>
<span class="co">#&gt; 2021-06-03 09:13:30 INFO::run iteration 7</span>
<span class="co">#&gt; 2021-06-03 09:13:33 INFO::After iteration 7, gene prior 0.12843387235542:, SNP prior:0.0277968216319187</span>
<span class="co">#&gt; 2021-06-03 09:13:33 INFO::run iteration 8</span>
<span class="co">#&gt; 2021-06-03 09:13:36 INFO::After iteration 8, gene prior 0.128456950378027:, SNP prior:0.0276985170674315</span>
<span class="co">#&gt; 2021-06-03 09:13:36 INFO::run iteration 9</span>
<span class="co">#&gt; 2021-06-03 09:13:39 INFO::After iteration 9, gene prior 0.128476380690169:, SNP prior:0.0276393026884224</span>
<span class="co">#&gt; 2021-06-03 09:13:39 INFO::run iteration 10</span>
<span class="co">#&gt; 2021-06-03 09:13:43 INFO::After iteration 10, gene prior 0.128493081469184:, SNP prior:0.0276103551493493</span>
<span class="co">#&gt; 2021-06-03 09:13:43 INFO::run iteration 11</span>
<span class="co">#&gt; 2021-06-03 09:13:46 INFO::After iteration 11, gene prior 0.128507602618014:, SNP prior:0.0276054787861447</span>
<span class="co">#&gt; 2021-06-03 09:13:46 INFO::run iteration 12</span>
<span class="co">#&gt; 2021-06-03 09:13:49 INFO::After iteration 12, gene prior 0.128520339836498:, SNP prior:0.0276201752680217</span>
<span class="co">#&gt; 2021-06-03 09:13:49 INFO::run iteration 13</span>
<span class="co">#&gt; 2021-06-03 09:13:52 INFO::After iteration 13, gene prior 0.128531596834341:, SNP prior:0.0276510876535264</span>
<span class="co">#&gt; 2021-06-03 09:13:52 INFO::run iteration 14</span>
<span class="co">#&gt; 2021-06-03 09:13:55 INFO::After iteration 14, gene prior 0.128541612372475:, SNP prior:0.0276956524931883</span>
<span class="co">#&gt; 2021-06-03 09:13:55 INFO::run iteration 15</span>
<span class="co">#&gt; 2021-06-03 09:13:58 INFO::After iteration 15, gene prior 0.128550576663045:, SNP prior:0.0277518736405968</span>
<span class="co">#&gt; 2021-06-03 09:13:58 INFO::run iteration 16</span>
<span class="co">#&gt; 2021-06-03 09:14:01 INFO::After iteration 16, gene prior 0.12855864287384:, SNP prior:0.0278181703671661</span>
<span class="co">#&gt; 2021-06-03 09:14:01 INFO::run iteration 17</span>
<span class="co">#&gt; 2021-06-03 09:14:05 INFO::After iteration 17, gene prior 0.128565935576113:, SNP prior:0.027893272507809</span>
<span class="co">#&gt; 2021-06-03 09:14:05 INFO::run iteration 18</span>
<span class="co">#&gt; 2021-06-03 09:14:08 INFO::After iteration 18, gene prior 0.128572557045648:, SNP prior:0.02797614631371</span>
<span class="co">#&gt; 2021-06-03 09:14:08 INFO::run iteration 19</span>
<span class="co">#&gt; 2021-06-03 09:14:11 INFO::After iteration 19, gene prior 0.128578592006234:, SNP prior:0.02806594090319</span>
<span class="co">#&gt; 2021-06-03 09:14:11 INFO::run iteration 20</span>
<span class="co">#&gt; 2021-06-03 09:14:14 INFO::After iteration 20, gene prior 0.128584111231673:, SNP prior:0.0281619488616011</span>
<span class="co">#&gt; 2021-06-03 09:14:14 INFO::run iteration 21</span>
<span class="co">#&gt; 2021-06-03 09:14:17 INFO::After iteration 21, gene prior 0.128589174305801:, SNP prior:0.0282635767670032</span>
<span class="co">#&gt; 2021-06-03 09:14:17 INFO::run iteration 22</span>
<span class="co">#&gt; 2021-06-03 09:14:21 INFO::After iteration 22, gene prior 0.128593831756961:, SNP prior:0.0283703228109484</span>
<span class="co">#&gt; 2021-06-03 09:14:21 INFO::run iteration 23</span>
<span class="co">#&gt; 2021-06-03 09:14:24 INFO::After iteration 23, gene prior 0.128598126723935:, SNP prior:0.0284817595772502</span>
<span class="co">#&gt; 2021-06-03 09:14:24 INFO::run iteration 24</span>
<span class="co">#&gt; 2021-06-03 09:14:27 INFO::After iteration 24, gene prior 0.128602096267854:, SNP prior:0.0285975206280638</span>
<span class="co">#&gt; 2021-06-03 09:14:27 INFO::run iteration 25</span>
<span class="co">#&gt; 2021-06-03 09:14:30 INFO::After iteration 25, gene prior 0.128605772414219:, SNP prior:0.0287172899394398</span>
<span class="co">#&gt; 2021-06-03 09:14:30 INFO::run iteration 26</span>
<span class="co">#&gt; 2021-06-03 09:14:33 INFO::After iteration 26, gene prior 0.128609182987345:, SNP prior:0.0288407934965563</span>
<span class="co">#&gt; 2021-06-03 09:14:33 INFO::run iteration 27</span>
<span class="co">#&gt; 2021-06-03 09:14:36 INFO::After iteration 27, gene prior 0.128612352283773:, SNP prior:0.0289677925448396</span>
<span class="co">#&gt; 2021-06-03 09:14:36 INFO::run iteration 28</span>
<span class="co">#&gt; 2021-06-03 09:14:39 INFO::After iteration 28, gene prior 0.128615301619718:, SNP prior:0.0290980781242547</span>
<span class="co">#&gt; 2021-06-03 09:14:39 INFO::run iteration 29</span>
<span class="co">#&gt; 2021-06-03 09:14:43 INFO::After iteration 29, gene prior 0.128618049779189:, SNP prior:0.0292314666077279</span>
<span class="co">#&gt; 2021-06-03 09:14:43 INFO::run iteration 30</span>
<span class="co">#&gt; 2021-06-03 09:14:46 INFO::After iteration 30, gene prior 0.128620613383213:, SNP prior:0.0293677960324965</span>
<span class="co">#&gt; 2021-06-03 09:14:46 INFO::Run susie for all regions.</span>
<span class="co">#&gt; 2021-06-03 09:14:46 INFO::run iteration 1</span>
<span class="co">#&gt; 2021-06-03 09:14:57 INFO::After iteration 1, gene prior 0.113965838175327:, SNP prior:0.138489926675173</span>
<span class="co">#&gt; 2021-06-03 09:14:57 INFO::No. LD regions: 374</span>
<span class="co">#&gt; 2021-06-03 09:14:57 INFO::No. regions with at least one SNP/gene for chr1: 17</span>
<span class="co">#&gt; 2021-06-03 09:14:57 INFO::Merge regions for chr1</span>
<span class="co">#&gt; 2021-06-03 09:14:57 INFO::No. regions with at least one SNP/gene for chr1 after merging: 17</span>
<span class="co">#&gt; 2021-06-03 09:14:57 INFO::No. regions with at least one SNP/gene for chr2: 17</span>
<span class="co">#&gt; 2021-06-03 09:14:57 INFO::Merge regions for chr2</span>
<span class="co">#&gt; 2021-06-03 09:14:57 INFO::No. regions with at least one SNP/gene for chr2 after merging: 17</span>
<span class="co">#&gt; 2021-06-03 09:14:57 INFO::No. regions with at least one SNP/gene for chr3: 17</span>
<span class="co">#&gt; 2021-06-03 09:14:57 INFO::Merge regions for chr3</span>
<span class="co">#&gt; 2021-06-03 09:14:57 INFO::No. regions with at least one SNP/gene for chr3 after merging: 17</span>
<span class="co">#&gt; 2021-06-03 09:14:57 INFO::No. regions with at least one SNP/gene for chr4: 17</span>
<span class="co">#&gt; 2021-06-03 09:14:57 INFO::Merge regions for chr4</span>
<span class="co">#&gt; 2021-06-03 09:14:57 INFO::No. regions with at least one SNP/gene for chr4 after merging: 16</span>
<span class="co">#&gt; 2021-06-03 09:14:57 INFO::No. regions with at least one SNP/gene for chr5: 17</span>
<span class="co">#&gt; 2021-06-03 09:14:57 INFO::Merge regions for chr5</span>
<span class="co">#&gt; 2021-06-03 09:14:57 INFO::No. regions with at least one SNP/gene for chr5 after merging: 17</span>
<span class="co">#&gt; 2021-06-03 09:14:57 INFO::No. regions with at least one SNP/gene for chr6: 17</span>
<span class="co">#&gt; 2021-06-03 09:14:57 INFO::Merge regions for chr6</span>
<span class="co">#&gt; 2021-06-03 09:14:57 INFO::No. regions with at least one SNP/gene for chr6 after merging: 17</span>
<span class="co">#&gt; 2021-06-03 09:14:57 INFO::No. regions with at least one SNP/gene for chr7: 17</span>
<span class="co">#&gt; 2021-06-03 09:14:57 INFO::Merge regions for chr7</span>
<span class="co">#&gt; 2021-06-03 09:14:57 INFO::No. regions with at least one SNP/gene for chr7 after merging: 16</span>
<span class="co">#&gt; 2021-06-03 09:14:57 INFO::No. regions with at least one SNP/gene for chr8: 17</span>
<span class="co">#&gt; 2021-06-03 09:14:57 INFO::Merge regions for chr8</span>
<span class="co">#&gt; 2021-06-03 09:14:57 INFO::No. regions with at least one SNP/gene for chr8 after merging: 16</span>
<span class="co">#&gt; 2021-06-03 09:14:57 INFO::No. regions with at least one SNP/gene for chr9: 17</span>
<span class="co">#&gt; 2021-06-03 09:14:57 INFO::Merge regions for chr9</span>
<span class="co">#&gt; 2021-06-03 09:14:57 INFO::No. regions with at least one SNP/gene for chr9 after merging: 17</span>
<span class="co">#&gt; 2021-06-03 09:14:57 INFO::No. regions with at least one SNP/gene for chr10: 17</span>
<span class="co">#&gt; 2021-06-03 09:14:57 INFO::Merge regions for chr10</span>
<span class="co">#&gt; 2021-06-03 09:14:57 INFO::No. regions with at least one SNP/gene for chr10 after merging: 16</span>
<span class="co">#&gt; 2021-06-03 09:14:57 INFO::No. regions with at least one SNP/gene for chr11: 17</span>
<span class="co">#&gt; 2021-06-03 09:14:57 INFO::Merge regions for chr11</span>
<span class="co">#&gt; 2021-06-03 09:14:57 INFO::No. regions with at least one SNP/gene for chr11 after merging: 16</span>
<span class="co">#&gt; 2021-06-03 09:14:57 INFO::No. regions with at least one SNP/gene for chr12: 17</span>
<span class="co">#&gt; 2021-06-03 09:14:57 INFO::Merge regions for chr12</span>
<span class="co">#&gt; 2021-06-03 09:14:57 INFO::No. regions with at least one SNP/gene for chr12 after merging: 16</span>
<span class="co">#&gt; 2021-06-03 09:14:58 INFO::No. regions with at least one SNP/gene for chr13: 17</span>
<span class="co">#&gt; 2021-06-03 09:14:58 INFO::Merge regions for chr13</span>
<span class="co">#&gt; 2021-06-03 09:14:58 INFO::No. regions with at least one SNP/gene for chr13 after merging: 16</span>
<span class="co">#&gt; 2021-06-03 09:14:58 INFO::No. regions with at least one SNP/gene for chr14: 17</span>
<span class="co">#&gt; 2021-06-03 09:14:58 INFO::Merge regions for chr14</span>
<span class="co">#&gt; 2021-06-03 09:14:58 INFO::No. regions with at least one SNP/gene for chr14 after merging: 16</span>
<span class="co">#&gt; 2021-06-03 09:14:58 INFO::No. regions with at least one SNP/gene for chr15: 17</span>
<span class="co">#&gt; 2021-06-03 09:14:58 INFO::Merge regions for chr15</span>
<span class="co">#&gt; 2021-06-03 09:14:58 INFO::No. regions with at least one SNP/gene for chr15 after merging: 16</span>
<span class="co">#&gt; 2021-06-03 09:14:58 INFO::No. regions with at least one SNP/gene for chr16: 17</span>
<span class="co">#&gt; 2021-06-03 09:14:58 INFO::Merge regions for chr16</span>
<span class="co">#&gt; 2021-06-03 09:14:58 INFO::No. regions with at least one SNP/gene for chr16 after merging: 17</span>
<span class="co">#&gt; 2021-06-03 09:14:58 INFO::No. regions with at least one SNP/gene for chr17: 17</span>
<span class="co">#&gt; 2021-06-03 09:14:58 INFO::Merge regions for chr17</span>
<span class="co">#&gt; 2021-06-03 09:14:58 INFO::No. regions with at least one SNP/gene for chr17 after merging: 16</span>
<span class="co">#&gt; 2021-06-03 09:14:58 INFO::No. regions with at least one SNP/gene for chr18: 17</span>
<span class="co">#&gt; 2021-06-03 09:14:58 INFO::Merge regions for chr18</span>
<span class="co">#&gt; 2021-06-03 09:14:58 INFO::No. regions with at least one SNP/gene for chr18 after merging: 16</span>
<span class="co">#&gt; 2021-06-03 09:14:58 INFO::No. regions with at least one SNP/gene for chr19: 17</span>
<span class="co">#&gt; 2021-06-03 09:14:58 INFO::Merge regions for chr19</span>
<span class="co">#&gt; 2021-06-03 09:14:58 INFO::No. regions with at least one SNP/gene for chr19 after merging: 17</span>
<span class="co">#&gt; 2021-06-03 09:14:58 INFO::No. regions with at least one SNP/gene for chr20: 17</span>
<span class="co">#&gt; 2021-06-03 09:14:58 INFO::Merge regions for chr20</span>
<span class="co">#&gt; 2021-06-03 09:14:58 INFO::No. regions with at least one SNP/gene for chr20 after merging: 17</span>
<span class="co">#&gt; 2021-06-03 09:14:58 INFO::No. regions with at least one SNP/gene for chr21: 17</span>
<span class="co">#&gt; 2021-06-03 09:14:58 INFO::Merge regions for chr21</span>
<span class="co">#&gt; 2021-06-03 09:14:58 INFO::No. regions with at least one SNP/gene for chr21 after merging: 17</span>
<span class="co">#&gt; 2021-06-03 09:14:58 INFO::No. regions with at least one SNP/gene for chr22: 17</span>
<span class="co">#&gt; 2021-06-03 09:14:58 INFO::Merge regions for chr22</span>
<span class="co">#&gt; 2021-06-03 09:14:58 INFO::No. regions with at least one SNP/gene for chr22 after merging: 17</span>
<span class="co">#&gt; 2021-06-03 09:14:58 INFO::Trim regions with SNPs more than 20</span>
<span class="co">#&gt; 2021-06-03 09:14:59 INFO::Number of regions that contains strong gene signals: 1</span>
<span class="co">#&gt; 2021-06-03 09:14:59 INFO::Rerun susie for regions with strong gene signals using full SNPs.</span>
<span class="co">#&gt; 2021-06-03 09:14:59 INFO::run iteration 1</span>
<span class="co">#&gt; 2021-06-03 09:15:01 INFO::After iteration 1, gene prior 1:, SNP prior:0.122064022562343</span></code></pre></div>
</div>
</div>
<div id="steps-when-using-ld-r-correlation-matrices" class="section level1">
<h1 class="hasAnchor">
<a href="#steps-when-using-ld-r-correlation-matrices" class="anchor"></a>Steps when using LD R (correlation) matrices</h1>
<div id="step-1-impute-expression-z-scores-1" class="section level2">
<h2 class="hasAnchor">
<a href="#step-1-impute-expression-z-scores-1" class="anchor"></a>Step 1: impute expression z scores</h2>
<p>In the following code, we compute expression z scores for each gene. We do this chromosome by chromosome. <code>impute_expr_z</code> will return z scores for each gene. It will also generate files containing the reference LD genotypes for eQTLs in the gene and the filename is returned. We will need these files in the <code>ctwas_rss</code> function in step 2.</p>
<p>When providing LD R matrices:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">outputdir</span> <span class="op">&lt;-</span> <span class="st">"~/temp"</span>

<span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/impute_expr_z.html">impute_expr_z</a></span><span class="op">(</span>z_snp <span class="op">=</span> <span class="va">z_snp</span>,  weight <span class="op">=</span> <span class="va">weight</span>, ld_R_dir <span class="op">=</span> <span class="va">ld_R_dir</span>,
                           method <span class="op">=</span> <span class="st">"lasso"</span>, outputdir <span class="op">=</span> <span class="va">outputdir</span>,
                           outname <span class="op">=</span> <span class="st">"test_ss"</span><span class="op">)</span>
<span class="co">#&gt; 2021-06-03 09:15:03 INFO::flipping z scores to match LD reference</span>
<span class="co">#&gt; 2021-06-03 09:15:03 INFO::will also flip weights to match LD reference for each gene</span>
<span class="co">#&gt; 2021-06-03 09:15:03 INFO::number of genes with weights provided: 20</span>
<span class="co">#&gt; 2021-06-03 09:15:03 INFO::number of genes on chromosome 1: 1</span>
<span class="co">#&gt; 2021-06-03 09:15:03 INFO::collecting gene weight information ...</span>
<span class="co">#&gt; 2021-06-03 09:15:03 INFO::Start gene z score imputation ...</span>
<span class="co">#&gt; 2021-06-03 09:15:03 INFO::Using given LD matrices to impute gene z score.</span>
<span class="co">#&gt; 2021-06-03 09:15:03 INFO::Imputation done, writing results to output...</span>
<span class="co">#&gt; 2021-06-03 09:15:03 INFO::Imputation done: number of genes with imputed expression: 1 for chr 1</span>
<span class="co">#&gt; 2021-06-03 09:15:03 INFO::flipping z scores to match LD reference</span>
<span class="co">#&gt; 2021-06-03 09:15:03 INFO::will also flip weights to match LD reference for each gene</span>
<span class="co">#&gt; 2021-06-03 09:15:03 INFO::number of genes with weights provided: 20</span>
<span class="co">#&gt; 2021-06-03 09:15:03 INFO::number of genes on chromosome 2: 1</span>
<span class="co">#&gt; 2021-06-03 09:15:03 INFO::collecting gene weight information ...</span>
<span class="co">#&gt; 2021-06-03 09:15:03 INFO::Start gene z score imputation ...</span>
<span class="co">#&gt; 2021-06-03 09:15:03 INFO::Using given LD matrices to impute gene z score.</span>
<span class="co">#&gt; 2021-06-03 09:15:03 INFO::Imputation done, writing results to output...</span>
<span class="co">#&gt; 2021-06-03 09:15:03 INFO::Imputation done: number of genes with imputed expression: 1 for chr 2</span>
<span class="co">#&gt; 2021-06-03 09:15:03 INFO::flipping z scores to match LD reference</span>
<span class="co">#&gt; 2021-06-03 09:15:03 INFO::will also flip weights to match LD reference for each gene</span>
<span class="co">#&gt; 2021-06-03 09:15:03 INFO::number of genes with weights provided: 20</span>
<span class="co">#&gt; 2021-06-03 09:15:03 INFO::number of genes on chromosome 3: 1</span>
<span class="co">#&gt; 2021-06-03 09:15:03 INFO::collecting gene weight information ...</span>
<span class="co">#&gt; 2021-06-03 09:15:03 INFO::Start gene z score imputation ...</span>
<span class="co">#&gt; 2021-06-03 09:15:03 INFO::Using given LD matrices to impute gene z score.</span>
<span class="co">#&gt; 2021-06-03 09:15:03 INFO::Imputation done, writing results to output...</span>
<span class="co">#&gt; 2021-06-03 09:15:03 INFO::Imputation done: number of genes with imputed expression: 1 for chr 3</span>
<span class="co">#&gt; 2021-06-03 09:15:03 INFO::flipping z scores to match LD reference</span>
<span class="co">#&gt; 2021-06-03 09:15:03 INFO::will also flip weights to match LD reference for each gene</span>
<span class="co">#&gt; 2021-06-03 09:15:03 INFO::number of genes with weights provided: 20</span>
<span class="co">#&gt; 2021-06-03 09:15:03 INFO::number of genes on chromosome 4: 1</span>
<span class="co">#&gt; 2021-06-03 09:15:03 INFO::collecting gene weight information ...</span>
<span class="co">#&gt; 2021-06-03 09:15:03 INFO::Start gene z score imputation ...</span>
<span class="co">#&gt; 2021-06-03 09:15:03 INFO::Using given LD matrices to impute gene z score.</span>
<span class="co">#&gt; 2021-06-03 09:15:03 INFO::Imputation done, writing results to output...</span>
<span class="co">#&gt; 2021-06-03 09:15:03 INFO::Imputation done: number of genes with imputed expression: 1 for chr 4</span>
<span class="co">#&gt; 2021-06-03 09:15:03 INFO::flipping z scores to match LD reference</span>
<span class="co">#&gt; 2021-06-03 09:15:03 INFO::will also flip weights to match LD reference for each gene</span>
<span class="co">#&gt; 2021-06-03 09:15:03 INFO::number of genes with weights provided: 20</span>
<span class="co">#&gt; 2021-06-03 09:15:03 INFO::number of genes on chromosome 5: 1</span>
<span class="co">#&gt; 2021-06-03 09:15:03 INFO::collecting gene weight information ...</span>
<span class="co">#&gt; 2021-06-03 09:15:03 INFO::Start gene z score imputation ...</span>
<span class="co">#&gt; 2021-06-03 09:15:03 INFO::Using given LD matrices to impute gene z score.</span>
<span class="co">#&gt; 2021-06-03 09:15:03 INFO::Imputation done, writing results to output...</span>
<span class="co">#&gt; 2021-06-03 09:15:03 INFO::Imputation done: number of genes with imputed expression: 1 for chr 5</span>
<span class="co">#&gt; 2021-06-03 09:15:03 INFO::flipping z scores to match LD reference</span>
<span class="co">#&gt; 2021-06-03 09:15:03 INFO::will also flip weights to match LD reference for each gene</span>
<span class="co">#&gt; 2021-06-03 09:15:03 INFO::number of genes with weights provided: 20</span>
<span class="co">#&gt; 2021-06-03 09:15:03 INFO::number of genes on chromosome 6: 1</span>
<span class="co">#&gt; 2021-06-03 09:15:03 INFO::collecting gene weight information ...</span>
<span class="co">#&gt; 2021-06-03 09:15:03 INFO::Start gene z score imputation ...</span>
<span class="co">#&gt; 2021-06-03 09:15:03 INFO::Using given LD matrices to impute gene z score.</span>
<span class="co">#&gt; 2021-06-03 09:15:03 INFO::Imputation done, writing results to output...</span>
<span class="co">#&gt; 2021-06-03 09:15:03 INFO::Imputation done: number of genes with imputed expression: 1 for chr 6</span>
<span class="co">#&gt; 2021-06-03 09:15:03 INFO::flipping z scores to match LD reference</span>
<span class="co">#&gt; 2021-06-03 09:15:03 INFO::will also flip weights to match LD reference for each gene</span>
<span class="co">#&gt; 2021-06-03 09:15:03 INFO::number of genes with weights provided: 20</span>
<span class="co">#&gt; 2021-06-03 09:15:03 INFO::number of genes on chromosome 7: 1</span>
<span class="co">#&gt; 2021-06-03 09:15:03 INFO::collecting gene weight information ...</span>
<span class="co">#&gt; 2021-06-03 09:15:03 INFO::Start gene z score imputation ...</span>
<span class="co">#&gt; 2021-06-03 09:15:03 INFO::Using given LD matrices to impute gene z score.</span>
<span class="co">#&gt; 2021-06-03 09:15:03 INFO::Imputation done, writing results to output...</span>
<span class="co">#&gt; 2021-06-03 09:15:03 INFO::Imputation done: number of genes with imputed expression: 1 for chr 7</span>
<span class="co">#&gt; 2021-06-03 09:15:03 INFO::flipping z scores to match LD reference</span>
<span class="co">#&gt; 2021-06-03 09:15:03 INFO::will also flip weights to match LD reference for each gene</span>
<span class="co">#&gt; 2021-06-03 09:15:03 INFO::number of genes with weights provided: 20</span>
<span class="co">#&gt; 2021-06-03 09:15:03 INFO::number of genes on chromosome 8: 1</span>
<span class="co">#&gt; 2021-06-03 09:15:03 INFO::collecting gene weight information ...</span>
<span class="co">#&gt; 2021-06-03 09:15:03 INFO::Start gene z score imputation ...</span>
<span class="co">#&gt; 2021-06-03 09:15:03 INFO::Using given LD matrices to impute gene z score.</span>
<span class="co">#&gt; 2021-06-03 09:15:03 INFO::Imputation done, writing results to output...</span>
<span class="co">#&gt; 2021-06-03 09:15:03 INFO::Imputation done: number of genes with imputed expression: 1 for chr 8</span>
<span class="co">#&gt; 2021-06-03 09:15:03 INFO::flipping z scores to match LD reference</span>
<span class="co">#&gt; 2021-06-03 09:15:03 INFO::will also flip weights to match LD reference for each gene</span>
<span class="co">#&gt; 2021-06-03 09:15:03 INFO::number of genes with weights provided: 20</span>
<span class="co">#&gt; 2021-06-03 09:15:03 INFO::number of genes on chromosome 9: 1</span>
<span class="co">#&gt; 2021-06-03 09:15:03 INFO::collecting gene weight information ...</span>
<span class="co">#&gt; 2021-06-03 09:15:03 INFO::Start gene z score imputation ...</span>
<span class="co">#&gt; 2021-06-03 09:15:03 INFO::Using given LD matrices to impute gene z score.</span>
<span class="co">#&gt; 2021-06-03 09:15:03 INFO::Imputation done, writing results to output...</span>
<span class="co">#&gt; 2021-06-03 09:15:03 INFO::Imputation done: number of genes with imputed expression: 1 for chr 9</span>
<span class="co">#&gt; 2021-06-03 09:15:04 INFO::flipping z scores to match LD reference</span>
<span class="co">#&gt; 2021-06-03 09:15:04 INFO::will also flip weights to match LD reference for each gene</span>
<span class="co">#&gt; 2021-06-03 09:15:04 INFO::number of genes with weights provided: 20</span>
<span class="co">#&gt; 2021-06-03 09:15:04 INFO::number of genes on chromosome 10: 1</span>
<span class="co">#&gt; 2021-06-03 09:15:04 INFO::collecting gene weight information ...</span>
<span class="co">#&gt; 2021-06-03 09:15:04 INFO::Start gene z score imputation ...</span>
<span class="co">#&gt; 2021-06-03 09:15:04 INFO::Using given LD matrices to impute gene z score.</span>
<span class="co">#&gt; 2021-06-03 09:15:04 INFO::Imputation done, writing results to output...</span>
<span class="co">#&gt; 2021-06-03 09:15:04 INFO::Imputation done: number of genes with imputed expression: 1 for chr 10</span>
<span class="co">#&gt; 2021-06-03 09:15:04 INFO::flipping z scores to match LD reference</span>
<span class="co">#&gt; 2021-06-03 09:15:04 INFO::will also flip weights to match LD reference for each gene</span>
<span class="co">#&gt; 2021-06-03 09:15:04 INFO::number of genes with weights provided: 20</span>
<span class="co">#&gt; 2021-06-03 09:15:04 INFO::number of genes on chromosome 11: 1</span>
<span class="co">#&gt; 2021-06-03 09:15:04 INFO::collecting gene weight information ...</span>
<span class="co">#&gt; 2021-06-03 09:15:04 INFO::Start gene z score imputation ...</span>
<span class="co">#&gt; 2021-06-03 09:15:04 INFO::Using given LD matrices to impute gene z score.</span>
<span class="co">#&gt; 2021-06-03 09:15:04 INFO::Imputation done, writing results to output...</span>
<span class="co">#&gt; 2021-06-03 09:15:04 INFO::Imputation done: number of genes with imputed expression: 1 for chr 11</span>
<span class="co">#&gt; 2021-06-03 09:15:04 INFO::flipping z scores to match LD reference</span>
<span class="co">#&gt; 2021-06-03 09:15:04 INFO::will also flip weights to match LD reference for each gene</span>
<span class="co">#&gt; 2021-06-03 09:15:04 INFO::number of genes with weights provided: 20</span>
<span class="co">#&gt; 2021-06-03 09:15:04 INFO::number of genes on chromosome 12: 1</span>
<span class="co">#&gt; 2021-06-03 09:15:04 INFO::collecting gene weight information ...</span>
<span class="co">#&gt; 2021-06-03 09:15:04 INFO::Start gene z score imputation ...</span>
<span class="co">#&gt; 2021-06-03 09:15:04 INFO::Using given LD matrices to impute gene z score.</span>
<span class="co">#&gt; 2021-06-03 09:15:04 INFO::Imputation done, writing results to output...</span>
<span class="co">#&gt; 2021-06-03 09:15:04 INFO::Imputation done: number of genes with imputed expression: 1 for chr 12</span>
<span class="co">#&gt; 2021-06-03 09:15:04 INFO::flipping z scores to match LD reference</span>
<span class="co">#&gt; 2021-06-03 09:15:04 INFO::will also flip weights to match LD reference for each gene</span>
<span class="co">#&gt; 2021-06-03 09:15:04 INFO::number of genes with weights provided: 20</span>
<span class="co">#&gt; 2021-06-03 09:15:04 INFO::number of genes on chromosome 13: 1</span>
<span class="co">#&gt; 2021-06-03 09:15:04 INFO::collecting gene weight information ...</span>
<span class="co">#&gt; 2021-06-03 09:15:04 INFO::Start gene z score imputation ...</span>
<span class="co">#&gt; 2021-06-03 09:15:04 INFO::Using given LD matrices to impute gene z score.</span>
<span class="co">#&gt; 2021-06-03 09:15:04 INFO::Imputation done, writing results to output...</span>
<span class="co">#&gt; 2021-06-03 09:15:04 INFO::Imputation done: number of genes with imputed expression: 1 for chr 13</span>
<span class="co">#&gt; 2021-06-03 09:15:04 INFO::flipping z scores to match LD reference</span>
<span class="co">#&gt; 2021-06-03 09:15:04 INFO::will also flip weights to match LD reference for each gene</span>
<span class="co">#&gt; 2021-06-03 09:15:04 INFO::number of genes with weights provided: 20</span>
<span class="co">#&gt; 2021-06-03 09:15:04 INFO::number of genes on chromosome 14: 1</span>
<span class="co">#&gt; 2021-06-03 09:15:04 INFO::collecting gene weight information ...</span>
<span class="co">#&gt; 2021-06-03 09:15:04 INFO::Start gene z score imputation ...</span>
<span class="co">#&gt; 2021-06-03 09:15:04 INFO::Using given LD matrices to impute gene z score.</span>
<span class="co">#&gt; 2021-06-03 09:15:04 INFO::Imputation done, writing results to output...</span>
<span class="co">#&gt; 2021-06-03 09:15:04 INFO::Imputation done: number of genes with imputed expression: 1 for chr 14</span>
<span class="co">#&gt; 2021-06-03 09:15:04 INFO::flipping z scores to match LD reference</span>
<span class="co">#&gt; 2021-06-03 09:15:04 INFO::will also flip weights to match LD reference for each gene</span>
<span class="co">#&gt; 2021-06-03 09:15:04 INFO::number of genes with weights provided: 20</span>
<span class="co">#&gt; 2021-06-03 09:15:04 INFO::number of genes on chromosome 15: 1</span>
<span class="co">#&gt; 2021-06-03 09:15:04 INFO::collecting gene weight information ...</span>
<span class="co">#&gt; 2021-06-03 09:15:04 INFO::Start gene z score imputation ...</span>
<span class="co">#&gt; 2021-06-03 09:15:04 INFO::Using given LD matrices to impute gene z score.</span>
<span class="co">#&gt; 2021-06-03 09:15:04 INFO::Imputation done, writing results to output...</span>
<span class="co">#&gt; 2021-06-03 09:15:04 INFO::Imputation done: number of genes with imputed expression: 1 for chr 15</span>
<span class="co">#&gt; 2021-06-03 09:15:04 INFO::flipping z scores to match LD reference</span>
<span class="co">#&gt; 2021-06-03 09:15:04 INFO::will also flip weights to match LD reference for each gene</span>
<span class="co">#&gt; 2021-06-03 09:15:04 INFO::number of genes with weights provided: 20</span>
<span class="co">#&gt; 2021-06-03 09:15:04 INFO::number of genes on chromosome 16: 1</span>
<span class="co">#&gt; 2021-06-03 09:15:04 INFO::collecting gene weight information ...</span>
<span class="co">#&gt; 2021-06-03 09:15:04 INFO::Start gene z score imputation ...</span>
<span class="co">#&gt; 2021-06-03 09:15:04 INFO::Using given LD matrices to impute gene z score.</span>
<span class="co">#&gt; 2021-06-03 09:15:04 INFO::Imputation done, writing results to output...</span>
<span class="co">#&gt; 2021-06-03 09:15:04 INFO::Imputation done: number of genes with imputed expression: 1 for chr 16</span>
<span class="co">#&gt; 2021-06-03 09:15:04 INFO::flipping z scores to match LD reference</span>
<span class="co">#&gt; 2021-06-03 09:15:04 INFO::will also flip weights to match LD reference for each gene</span>
<span class="co">#&gt; 2021-06-03 09:15:04 INFO::number of genes with weights provided: 20</span>
<span class="co">#&gt; 2021-06-03 09:15:04 INFO::number of genes on chromosome 17: 1</span>
<span class="co">#&gt; 2021-06-03 09:15:04 INFO::collecting gene weight information ...</span>
<span class="co">#&gt; 2021-06-03 09:15:04 INFO::Start gene z score imputation ...</span>
<span class="co">#&gt; 2021-06-03 09:15:04 INFO::Using given LD matrices to impute gene z score.</span>
<span class="co">#&gt; 2021-06-03 09:15:04 INFO::Imputation done, writing results to output...</span>
<span class="co">#&gt; 2021-06-03 09:15:04 INFO::Imputation done: number of genes with imputed expression: 1 for chr 17</span>
<span class="co">#&gt; 2021-06-03 09:15:04 INFO::flipping z scores to match LD reference</span>
<span class="co">#&gt; 2021-06-03 09:15:04 INFO::will also flip weights to match LD reference for each gene</span>
<span class="co">#&gt; 2021-06-03 09:15:04 INFO::number of genes with weights provided: 20</span>
<span class="co">#&gt; 2021-06-03 09:15:04 INFO::number of genes on chromosome 18: 1</span>
<span class="co">#&gt; 2021-06-03 09:15:04 INFO::collecting gene weight information ...</span>
<span class="co">#&gt; 2021-06-03 09:15:04 INFO::Start gene z score imputation ...</span>
<span class="co">#&gt; 2021-06-03 09:15:04 INFO::Using given LD matrices to impute gene z score.</span>
<span class="co">#&gt; 2021-06-03 09:15:04 INFO::Imputation done, writing results to output...</span>
<span class="co">#&gt; 2021-06-03 09:15:04 INFO::Imputation done: number of genes with imputed expression: 1 for chr 18</span>
<span class="co">#&gt; 2021-06-03 09:15:04 INFO::flipping z scores to match LD reference</span>
<span class="co">#&gt; 2021-06-03 09:15:04 INFO::will also flip weights to match LD reference for each gene</span>
<span class="co">#&gt; 2021-06-03 09:15:04 INFO::number of genes with weights provided: 20</span>
<span class="co">#&gt; 2021-06-03 09:15:04 INFO::number of genes on chromosome 19: 1</span>
<span class="co">#&gt; 2021-06-03 09:15:04 INFO::collecting gene weight information ...</span>
<span class="co">#&gt; 2021-06-03 09:15:04 INFO::Start gene z score imputation ...</span>
<span class="co">#&gt; 2021-06-03 09:15:04 INFO::Using given LD matrices to impute gene z score.</span>
<span class="co">#&gt; 2021-06-03 09:15:04 INFO::Imputation done, writing results to output...</span>
<span class="co">#&gt; 2021-06-03 09:15:04 INFO::Imputation done: number of genes with imputed expression: 1 for chr 19</span>
<span class="co">#&gt; 2021-06-03 09:15:04 INFO::flipping z scores to match LD reference</span>
<span class="co">#&gt; 2021-06-03 09:15:04 INFO::will also flip weights to match LD reference for each gene</span>
<span class="co">#&gt; 2021-06-03 09:15:04 INFO::number of genes with weights provided: 20</span>
<span class="co">#&gt; 2021-06-03 09:15:04 INFO::number of genes on chromosome 20: 1</span>
<span class="co">#&gt; 2021-06-03 09:15:04 INFO::collecting gene weight information ...</span>
<span class="co">#&gt; 2021-06-03 09:15:04 INFO::Start gene z score imputation ...</span>
<span class="co">#&gt; 2021-06-03 09:15:04 INFO::Using given LD matrices to impute gene z score.</span>
<span class="co">#&gt; 2021-06-03 09:15:04 INFO::Imputation done, writing results to output...</span>
<span class="co">#&gt; 2021-06-03 09:15:04 INFO::Imputation done: number of genes with imputed expression: 1 for chr 20</span>
<span class="co">#&gt; 2021-06-03 09:15:04 INFO::flipping z scores to match LD reference</span>
<span class="co">#&gt; 2021-06-03 09:15:05 INFO::will also flip weights to match LD reference for each gene</span>
<span class="co">#&gt; 2021-06-03 09:15:05 INFO::number of genes with weights provided: 20</span>
<span class="co">#&gt; 2021-06-03 09:15:05 INFO::number of genes on chromosome 21: 0</span>
<span class="co">#&gt; 2021-06-03 09:15:05 INFO::collecting gene weight information ...</span>
<span class="co">#&gt; 2021-06-03 09:15:05 INFO::Imputation done, writing results to output...</span>
<span class="co">#&gt; 2021-06-03 09:15:05 INFO::Imputation done: number of genes with imputed expression: 0 for chr 21</span>
<span class="co">#&gt; 2021-06-03 09:15:05 INFO::flipping z scores to match LD reference</span>
<span class="co">#&gt; 2021-06-03 09:15:05 INFO::will also flip weights to match LD reference for each gene</span>
<span class="co">#&gt; 2021-06-03 09:15:05 INFO::number of genes with weights provided: 20</span>
<span class="co">#&gt; 2021-06-03 09:15:05 INFO::number of genes on chromosome 22: 0</span>
<span class="co">#&gt; 2021-06-03 09:15:05 INFO::collecting gene weight information ...</span>
<span class="co">#&gt; 2021-06-03 09:15:05 INFO::Imputation done, writing results to output...</span>
<span class="co">#&gt; 2021-06-03 09:15:05 INFO::Imputation done: number of genes with imputed expression: 0 for chr 22</span>
<span class="va">z_gene</span> <span class="op">&lt;-</span> <span class="va">res</span><span class="op">$</span><span class="va">z_gene</span>
<span class="va">ld_exprfs</span> <span class="op">&lt;-</span> <span class="va">res</span><span class="op">$</span><span class="va">ld_exprfs</span>

<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">z_gene</span><span class="op">)</span>
<span class="co">#&gt;          id          z</span>
<span class="co">#&gt; gene1 gene1 18.4624001</span>
<span class="co">#&gt; gene2 gene2 -1.7169590</span>
<span class="co">#&gt; gene3 gene3 -0.4940096</span>
<span class="co">#&gt; gene4 gene4 -0.5310785</span>
<span class="co">#&gt; gene5 gene5 -0.1813120</span>
<span class="co">#&gt; gene6 gene6 -0.2698443</span>
<span class="va">ld_exprfs</span>
<span class="co">#&gt;  [1] "~/temp/test_ss_chr1.expr.gz"  "~/temp/test_ss_chr2.expr.gz" </span>
<span class="co">#&gt;  [3] "~/temp/test_ss_chr3.expr.gz"  "~/temp/test_ss_chr4.expr.gz" </span>
<span class="co">#&gt;  [5] "~/temp/test_ss_chr5.expr.gz"  "~/temp/test_ss_chr6.expr.gz" </span>
<span class="co">#&gt;  [7] "~/temp/test_ss_chr7.expr.gz"  "~/temp/test_ss_chr8.expr.gz" </span>
<span class="co">#&gt;  [9] "~/temp/test_ss_chr9.expr.gz"  "~/temp/test_ss_chr10.expr.gz"</span>
<span class="co">#&gt; [11] "~/temp/test_ss_chr11.expr.gz" "~/temp/test_ss_chr12.expr.gz"</span>
<span class="co">#&gt; [13] "~/temp/test_ss_chr13.expr.gz" "~/temp/test_ss_chr14.expr.gz"</span>
<span class="co">#&gt; [15] "~/temp/test_ss_chr15.expr.gz" "~/temp/test_ss_chr16.expr.gz"</span>
<span class="co">#&gt; [17] "~/temp/test_ss_chr17.expr.gz" "~/temp/test_ss_chr18.expr.gz"</span>
<span class="co">#&gt; [19] "~/temp/test_ss_chr19.expr.gz" "~/temp/test_ss_chr20.expr.gz"</span>
<span class="co">#&gt; [21] "~/temp/test_ss_chr21.expr.gz" "~/temp/test_ss_chr22.expr.gz"</span></code></pre></div>
</div>
<div id="step-2-run-ctwas_rss--1" class="section level2">
<h2 class="hasAnchor">
<a href="#step-2-run-ctwas_rss--1" class="anchor"></a>Step 2: run <code>ctwas_rss</code>.</h2>
<p>In this step we will perform the causal TWAS algorithm, the algorithm will run susie iteratively for parameter estimation and lastly provide PIPs for all genes and SNPs included in the analysis. If you don’t want to define your own LD regions, then you can use the one defined by ldetect by simply specifying the population name using the <code>ld_regions</code> argument. One feature of the ctwas function is that it allows parallel computing. you can specify number of cores to use by the <code>ncore</code> argument.</p>
<p>When providing LD R matrices, use the following command:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pars</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ctwas_rss.html">ctwas_rss</a></span><span class="op">(</span>z_gene <span class="op">=</span> <span class="va">z_gene</span>, z_snp <span class="op">=</span> <span class="va">z_snp</span>, ld_exprfs <span class="op">=</span> <span class="va">ld_exprfs</span>, ld_R_dir <span class="op">=</span> <span class="va">ld_R_dir</span>, ld_regions_custom <span class="op">=</span> <span class="va">regionsfile</span>, thin <span class="op">=</span> <span class="fl">0.9</span>, max_snp_region <span class="op">=</span> <span class="fl">20</span>, outputdir <span class="op">=</span> <span class="va">outputdir</span>, outname <span class="op">=</span> <span class="st">"test_ss"</span>, ncore <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>
<span class="co">#&gt; 2021-06-03 09:15:05 INFO::ctwas started ...</span>
<span class="co">#&gt; 2021-06-03 09:15:06 INFO::LD region file: /tmp/Rtmpaaycpe/temp_libpath6e24f5908f2/ctwas/extdata/example_regions.bed</span>
<span class="co">#&gt; 2021-06-03 09:15:06 INFO::flipping z scores to match LD reference</span>
<span class="co">#&gt; 2021-06-03 09:15:06 INFO::No. LD regions: 374</span>
<span class="co">#&gt; 2021-06-03 09:15:06 INFO::No. regions with at least one SNP/gene for chr1: 17</span>
<span class="co">#&gt; 2021-06-03 09:15:06 INFO::Merge regions for chr1</span>
<span class="co">#&gt; 2021-06-03 09:15:06 INFO::No. regions with at least one SNP/gene for chr1 after merging: 17</span>
<span class="co">#&gt; 2021-06-03 09:15:06 INFO::No. regions with at least one SNP/gene for chr2: 17</span>
<span class="co">#&gt; 2021-06-03 09:15:06 INFO::Merge regions for chr2</span>
<span class="co">#&gt; 2021-06-03 09:15:06 INFO::No. regions with at least one SNP/gene for chr2 after merging: 17</span>
<span class="co">#&gt; 2021-06-03 09:15:06 INFO::No. regions with at least one SNP/gene for chr3: 17</span>
<span class="co">#&gt; 2021-06-03 09:15:06 INFO::Merge regions for chr3</span>
<span class="co">#&gt; 2021-06-03 09:15:06 INFO::No. regions with at least one SNP/gene for chr3 after merging: 17</span>
<span class="co">#&gt; 2021-06-03 09:15:06 INFO::No. regions with at least one SNP/gene for chr4: 17</span>
<span class="co">#&gt; 2021-06-03 09:15:06 INFO::Merge regions for chr4</span>
<span class="co">#&gt; 2021-06-03 09:15:06 INFO::No. regions with at least one SNP/gene for chr4 after merging: 16</span>
<span class="co">#&gt; 2021-06-03 09:15:06 INFO::No. regions with at least one SNP/gene for chr5: 17</span>
<span class="co">#&gt; 2021-06-03 09:15:06 INFO::Merge regions for chr5</span>
<span class="co">#&gt; 2021-06-03 09:15:06 INFO::No. regions with at least one SNP/gene for chr5 after merging: 17</span>
<span class="co">#&gt; 2021-06-03 09:15:06 INFO::No. regions with at least one SNP/gene for chr6: 17</span>
<span class="co">#&gt; 2021-06-03 09:15:06 INFO::Merge regions for chr6</span>
<span class="co">#&gt; 2021-06-03 09:15:06 INFO::No. regions with at least one SNP/gene for chr6 after merging: 17</span>
<span class="co">#&gt; 2021-06-03 09:15:07 INFO::No. regions with at least one SNP/gene for chr7: 17</span>
<span class="co">#&gt; 2021-06-03 09:15:07 INFO::Merge regions for chr7</span>
<span class="co">#&gt; 2021-06-03 09:15:07 INFO::No. regions with at least one SNP/gene for chr7 after merging: 16</span>
<span class="co">#&gt; 2021-06-03 09:15:07 INFO::No. regions with at least one SNP/gene for chr8: 17</span>
<span class="co">#&gt; 2021-06-03 09:15:07 INFO::Merge regions for chr8</span>
<span class="co">#&gt; 2021-06-03 09:15:07 INFO::No. regions with at least one SNP/gene for chr8 after merging: 16</span>
<span class="co">#&gt; 2021-06-03 09:15:07 INFO::No. regions with at least one SNP/gene for chr9: 17</span>
<span class="co">#&gt; 2021-06-03 09:15:07 INFO::Merge regions for chr9</span>
<span class="co">#&gt; 2021-06-03 09:15:07 INFO::No. regions with at least one SNP/gene for chr9 after merging: 17</span>
<span class="co">#&gt; 2021-06-03 09:15:07 INFO::No. regions with at least one SNP/gene for chr10: 17</span>
<span class="co">#&gt; 2021-06-03 09:15:07 INFO::Merge regions for chr10</span>
<span class="co">#&gt; 2021-06-03 09:15:07 INFO::No. regions with at least one SNP/gene for chr10 after merging: 16</span>
<span class="co">#&gt; 2021-06-03 09:15:07 INFO::No. regions with at least one SNP/gene for chr11: 17</span>
<span class="co">#&gt; 2021-06-03 09:15:07 INFO::Merge regions for chr11</span>
<span class="co">#&gt; 2021-06-03 09:15:07 INFO::No. regions with at least one SNP/gene for chr11 after merging: 16</span>
<span class="co">#&gt; 2021-06-03 09:15:07 INFO::No. regions with at least one SNP/gene for chr12: 17</span>
<span class="co">#&gt; 2021-06-03 09:15:07 INFO::Merge regions for chr12</span>
<span class="co">#&gt; 2021-06-03 09:15:07 INFO::No. regions with at least one SNP/gene for chr12 after merging: 16</span>
<span class="co">#&gt; 2021-06-03 09:15:07 INFO::No. regions with at least one SNP/gene for chr13: 17</span>
<span class="co">#&gt; 2021-06-03 09:15:07 INFO::Merge regions for chr13</span>
<span class="co">#&gt; 2021-06-03 09:15:07 INFO::No. regions with at least one SNP/gene for chr13 after merging: 16</span>
<span class="co">#&gt; 2021-06-03 09:15:07 INFO::No. regions with at least one SNP/gene for chr14: 17</span>
<span class="co">#&gt; 2021-06-03 09:15:07 INFO::Merge regions for chr14</span>
<span class="co">#&gt; 2021-06-03 09:15:07 INFO::No. regions with at least one SNP/gene for chr14 after merging: 16</span>
<span class="co">#&gt; 2021-06-03 09:15:07 INFO::No. regions with at least one SNP/gene for chr15: 17</span>
<span class="co">#&gt; 2021-06-03 09:15:07 INFO::Merge regions for chr15</span>
<span class="co">#&gt; 2021-06-03 09:15:07 INFO::No. regions with at least one SNP/gene for chr15 after merging: 16</span>
<span class="co">#&gt; 2021-06-03 09:15:07 INFO::No. regions with at least one SNP/gene for chr16: 17</span>
<span class="co">#&gt; 2021-06-03 09:15:07 INFO::Merge regions for chr16</span>
<span class="co">#&gt; 2021-06-03 09:15:07 INFO::No. regions with at least one SNP/gene for chr16 after merging: 17</span>
<span class="co">#&gt; 2021-06-03 09:15:07 INFO::No. regions with at least one SNP/gene for chr17: 17</span>
<span class="co">#&gt; 2021-06-03 09:15:07 INFO::Merge regions for chr17</span>
<span class="co">#&gt; 2021-06-03 09:15:07 INFO::No. regions with at least one SNP/gene for chr17 after merging: 16</span>
<span class="co">#&gt; 2021-06-03 09:15:07 INFO::No. regions with at least one SNP/gene for chr18: 17</span>
<span class="co">#&gt; 2021-06-03 09:15:07 INFO::Merge regions for chr18</span>
<span class="co">#&gt; 2021-06-03 09:15:07 INFO::No. regions with at least one SNP/gene for chr18 after merging: 16</span>
<span class="co">#&gt; 2021-06-03 09:15:07 INFO::No. regions with at least one SNP/gene for chr19: 17</span>
<span class="co">#&gt; 2021-06-03 09:15:07 INFO::Merge regions for chr19</span>
<span class="co">#&gt; 2021-06-03 09:15:07 INFO::No. regions with at least one SNP/gene for chr19 after merging: 17</span>
<span class="co">#&gt; 2021-06-03 09:15:07 INFO::No. regions with at least one SNP/gene for chr20: 17</span>
<span class="co">#&gt; 2021-06-03 09:15:07 INFO::Merge regions for chr20</span>
<span class="co">#&gt; 2021-06-03 09:15:07 INFO::No. regions with at least one SNP/gene for chr20 after merging: 17</span>
<span class="co">#&gt; 2021-06-03 09:15:07 INFO::No. regions with at least one SNP/gene for chr21: 17</span>
<span class="co">#&gt; 2021-06-03 09:15:07 INFO::Merge regions for chr21</span>
<span class="co">#&gt; 2021-06-03 09:15:07 INFO::No. regions with at least one SNP/gene for chr21 after merging: 17</span>
<span class="co">#&gt; 2021-06-03 09:15:07 INFO::No. regions with at least one SNP/gene for chr22: 17</span>
<span class="co">#&gt; 2021-06-03 09:15:07 INFO::Merge regions for chr22</span>
<span class="co">#&gt; 2021-06-03 09:15:07 INFO::No. regions with at least one SNP/gene for chr22 after merging: 17</span>
<span class="co">#&gt; 2021-06-03 09:15:07 INFO::Trim regions with SNPs more than Inf</span>
<span class="co">#&gt; 2021-06-03 09:15:07 INFO::Adding R matrix info, as genotype is not given</span>
<span class="co">#&gt; 2021-06-03 09:15:07 INFO::Adding R matrix info for chrom 1</span>
<span class="co">#&gt; 2021-06-03 09:15:08 INFO::Adding R matrix info for chrom 2</span>
<span class="co">#&gt; 2021-06-03 09:15:08 INFO::Adding R matrix info for chrom 3</span>
<span class="co">#&gt; 2021-06-03 09:15:08 INFO::Adding R matrix info for chrom 4</span>
<span class="co">#&gt; 2021-06-03 09:15:09 INFO::Adding R matrix info for chrom 5</span>
<span class="co">#&gt; 2021-06-03 09:15:09 INFO::Adding R matrix info for chrom 6</span>
<span class="co">#&gt; 2021-06-03 09:15:09 INFO::Adding R matrix info for chrom 7</span>
<span class="co">#&gt; 2021-06-03 09:15:09 INFO::Adding R matrix info for chrom 8</span>
<span class="co">#&gt; 2021-06-03 09:15:10 INFO::Adding R matrix info for chrom 9</span>
<span class="co">#&gt; 2021-06-03 09:15:10 INFO::Adding R matrix info for chrom 10</span>
<span class="co">#&gt; 2021-06-03 09:15:10 INFO::Adding R matrix info for chrom 11</span>
<span class="co">#&gt; 2021-06-03 09:15:11 INFO::Adding R matrix info for chrom 12</span>
<span class="co">#&gt; 2021-06-03 09:15:11 INFO::Adding R matrix info for chrom 13</span>
<span class="co">#&gt; 2021-06-03 09:15:11 INFO::Adding R matrix info for chrom 14</span>
<span class="co">#&gt; 2021-06-03 09:15:12 INFO::Adding R matrix info for chrom 15</span>
<span class="co">#&gt; 2021-06-03 09:15:12 INFO::Adding R matrix info for chrom 16</span>
<span class="co">#&gt; 2021-06-03 09:15:12 INFO::Adding R matrix info for chrom 17</span>
<span class="co">#&gt; 2021-06-03 09:15:13 INFO::Adding R matrix info for chrom 18</span>
<span class="co">#&gt; 2021-06-03 09:15:13 INFO::Adding R matrix info for chrom 19</span>
<span class="co">#&gt; 2021-06-03 09:15:13 INFO::Adding R matrix info for chrom 20</span>
<span class="co">#&gt; 2021-06-03 09:15:14 INFO::Adding R matrix info for chrom 21</span>
<span class="co">#&gt; 2021-06-03 09:15:14 INFO::Adding R matrix info for chrom 22</span>
<span class="co">#&gt; 2021-06-03 09:15:14 INFO::Run susie iteratively, getting rough estimate ...</span>
<span class="co">#&gt; 2021-06-03 09:15:14 INFO::run iteration 1</span>
<span class="co">#&gt; 2021-06-03 09:15:19 INFO::After iteration 1, gene prior 0.182071436616161:, SNP prior:0.03746440484442</span>
<span class="co">#&gt; 2021-06-03 09:15:19 INFO::run iteration 2</span>
<span class="co">#&gt; 2021-06-03 09:15:25 INFO::After iteration 2, gene prior 0.105026103339378:, SNP prior:0.0358910262612177</span>
<span class="co">#&gt; 2021-06-03 09:15:25 INFO::run iteration 3</span>
<span class="co">#&gt; 2021-06-03 09:15:30 INFO::After iteration 3, gene prior 0.0754309047368718:, SNP prior:0.035204891354971</span>
<span class="co">#&gt; 2021-06-03 09:15:30 INFO::Blocks are filtered: 11 blocks left</span>
<span class="co">#&gt; 2021-06-03 09:15:30 INFO::Run susie iteratively, getting accurate estimate ...</span>
<span class="co">#&gt; 2021-06-03 09:15:30 INFO::run iteration 1</span>
<span class="co">#&gt; 2021-06-03 09:15:32 INFO::After iteration 1, gene prior 0.122501316616366:, SNP prior:0.0245617877007893</span>
<span class="co">#&gt; 2021-06-03 09:15:32 INFO::run iteration 2</span>
<span class="co">#&gt; 2021-06-03 09:15:34 INFO::After iteration 2, gene prior 0.127432210427403:, SNP prior:0.0213106631766159</span>
<span class="co">#&gt; 2021-06-03 09:15:34 INFO::run iteration 3</span>
<span class="co">#&gt; 2021-06-03 09:15:36 INFO::After iteration 3, gene prior 0.128448878753661:, SNP prior:0.0195333397842195</span>
<span class="co">#&gt; 2021-06-03 09:15:36 INFO::run iteration 4</span>
<span class="co">#&gt; 2021-06-03 09:15:37 INFO::After iteration 4, gene prior 0.128678110322031:, SNP prior:0.018348890367087</span>
<span class="co">#&gt; 2021-06-03 09:15:37 INFO::run iteration 5</span>
<span class="co">#&gt; 2021-06-03 09:15:39 INFO::After iteration 5, gene prior 0.128738567338109:, SNP prior:0.0174748856892675</span>
<span class="co">#&gt; 2021-06-03 09:15:39 INFO::run iteration 6</span>
<span class="co">#&gt; 2021-06-03 09:15:41 INFO::After iteration 6, gene prior 0.128761361933474:, SNP prior:0.0167891912481062</span>
<span class="co">#&gt; 2021-06-03 09:15:41 INFO::run iteration 7</span>
<span class="co">#&gt; 2021-06-03 09:15:43 INFO::After iteration 7, gene prior 0.128774649289401:, SNP prior:0.0162287910244394</span>
<span class="co">#&gt; 2021-06-03 09:15:43 INFO::run iteration 8</span>
<span class="co">#&gt; 2021-06-03 09:15:45 INFO::After iteration 8, gene prior 0.128784674884784:, SNP prior:0.0157571957780964</span>
<span class="co">#&gt; 2021-06-03 09:15:45 INFO::run iteration 9</span>
<span class="co">#&gt; 2021-06-03 09:15:47 INFO::After iteration 9, gene prior 0.128792991292574:, SNP prior:0.015351509831133</span>
<span class="co">#&gt; 2021-06-03 09:15:47 INFO::run iteration 10</span>
<span class="co">#&gt; 2021-06-03 09:15:48 INFO::After iteration 10, gene prior 0.12880011521214:, SNP prior:0.0149964922625565</span>
<span class="co">#&gt; 2021-06-03 09:15:48 INFO::run iteration 11</span>
<span class="co">#&gt; 2021-06-03 09:15:50 INFO::After iteration 11, gene prior 0.128806306784461:, SNP prior:0.0146815251890626</span>
<span class="co">#&gt; 2021-06-03 09:15:50 INFO::run iteration 12</span>
<span class="co">#&gt; 2021-06-03 09:15:52 INFO::After iteration 12, gene prior 0.128811740650231:, SNP prior:0.0143989381832964</span>
<span class="co">#&gt; 2021-06-03 09:15:52 INFO::run iteration 13</span>
<span class="co">#&gt; 2021-06-03 09:15:54 INFO::After iteration 13, gene prior 0.128816548431023:, SNP prior:0.0141430232770228</span>
<span class="co">#&gt; 2021-06-03 09:15:54 INFO::run iteration 14</span>
<span class="co">#&gt; 2021-06-03 09:15:56 INFO::After iteration 14, gene prior 0.128820833207632:, SNP prior:0.013909426533009</span>
<span class="co">#&gt; 2021-06-03 09:15:56 INFO::run iteration 15</span>
<span class="co">#&gt; 2021-06-03 09:15:58 INFO::After iteration 15, gene prior 0.128824676994723:, SNP prior:0.0136947565678126</span>
<span class="co">#&gt; 2021-06-03 09:15:58 INFO::run iteration 16</span>
<span class="co">#&gt; 2021-06-03 09:15:59 INFO::After iteration 16, gene prior 0.12882814573029:, SNP prior:0.0134963238712331</span>
<span class="co">#&gt; 2021-06-03 09:15:59 INFO::run iteration 17</span>
<span class="co">#&gt; 2021-06-03 09:16:01 INFO::After iteration 17, gene prior 0.128831292922053:, SNP prior:0.0133119620572124</span>
<span class="co">#&gt; 2021-06-03 09:16:01 INFO::run iteration 18</span>
<span class="co">#&gt; 2021-06-03 09:16:03 INFO::After iteration 18, gene prior 0.12883416238073:, SNP prior:0.0131399021469813</span>
<span class="co">#&gt; 2021-06-03 09:16:03 INFO::run iteration 19</span>
<span class="co">#&gt; 2021-06-03 09:16:05 INFO::After iteration 19, gene prior 0.128836790287537:, SNP prior:0.0129786821688169</span>
<span class="co">#&gt; 2021-06-03 09:16:05 INFO::run iteration 20</span>
<span class="co">#&gt; 2021-06-03 09:16:06 INFO::After iteration 20, gene prior 0.128839206768737:, SNP prior:0.0128270808703129</span>
<span class="co">#&gt; 2021-06-03 09:16:06 INFO::run iteration 21</span>
<span class="co">#&gt; 2021-06-03 09:16:08 INFO::After iteration 21, gene prior 0.128841437103527:, SNP prior:0.0126840682603186</span>
<span class="co">#&gt; 2021-06-03 09:16:08 INFO::run iteration 22</span>
<span class="co">#&gt; 2021-06-03 09:16:10 INFO::After iteration 22, gene prior 0.128843502658103:, SNP prior:0.0125487681301962</span>
<span class="co">#&gt; 2021-06-03 09:16:10 INFO::run iteration 23</span>
<span class="co">#&gt; 2021-06-03 09:16:12 INFO::After iteration 23, gene prior 0.128845421613987:, SNP prior:0.0124204292532766</span>
<span class="co">#&gt; 2021-06-03 09:16:12 INFO::run iteration 24</span>
<span class="co">#&gt; 2021-06-03 09:16:14 INFO::After iteration 24, gene prior 0.128847209540713:, SNP prior:0.0122984029716046</span>
<span class="co">#&gt; 2021-06-03 09:16:14 INFO::run iteration 25</span>
<span class="co">#&gt; 2021-06-03 09:16:15 INFO::After iteration 25, gene prior 0.128848879849829:, SNP prior:0.0121821255519112</span>
<span class="co">#&gt; 2021-06-03 09:16:15 INFO::run iteration 26</span>
<span class="co">#&gt; 2021-06-03 09:16:17 INFO::After iteration 26, gene prior 0.128850444157677:, SNP prior:0.0120711041495756</span>
<span class="co">#&gt; 2021-06-03 09:16:17 INFO::run iteration 27</span>
<span class="co">#&gt; 2021-06-03 09:16:19 INFO::After iteration 27, gene prior 0.128851912577487:, SNP prior:0.0119649055349574</span>
<span class="co">#&gt; 2021-06-03 09:16:19 INFO::run iteration 28</span>
<span class="co">#&gt; 2021-06-03 09:16:21 INFO::After iteration 28, gene prior 0.128853293956248:, SNP prior:0.0118631469580429</span>
<span class="co">#&gt; 2021-06-03 09:16:21 INFO::run iteration 29</span>
<span class="co">#&gt; 2021-06-03 09:16:23 INFO::After iteration 29, gene prior 0.128854596068133:, SNP prior:0.0117654886851768</span>
<span class="co">#&gt; 2021-06-03 09:16:23 INFO::run iteration 30</span>
<span class="co">#&gt; 2021-06-03 09:16:25 INFO::After iteration 30, gene prior 0.128855825773462:, SNP prior:0.0116716278555945</span>
<span class="co">#&gt; 2021-06-03 09:16:25 INFO::Run susie for all regions.</span>
<span class="co">#&gt; 2021-06-03 09:16:25 INFO::run iteration 1</span>
<span class="co">#&gt; 2021-06-03 09:16:31 INFO::After iteration 1, gene prior 0.119773952871303:, SNP prior:0.0594530674263792</span>
<span class="co">#&gt; 2021-06-03 09:16:31 INFO::No. LD regions: 374</span>
<span class="co">#&gt; 2021-06-03 09:16:31 INFO::No. regions with at least one SNP/gene for chr1: 17</span>
<span class="co">#&gt; 2021-06-03 09:16:31 INFO::Merge regions for chr1</span>
<span class="co">#&gt; 2021-06-03 09:16:31 INFO::No. regions with at least one SNP/gene for chr1 after merging: 17</span>
<span class="co">#&gt; 2021-06-03 09:16:31 INFO::No. regions with at least one SNP/gene for chr2: 17</span>
<span class="co">#&gt; 2021-06-03 09:16:31 INFO::Merge regions for chr2</span>
<span class="co">#&gt; 2021-06-03 09:16:31 INFO::No. regions with at least one SNP/gene for chr2 after merging: 17</span>
<span class="co">#&gt; 2021-06-03 09:16:31 INFO::No. regions with at least one SNP/gene for chr3: 17</span>
<span class="co">#&gt; 2021-06-03 09:16:31 INFO::Merge regions for chr3</span>
<span class="co">#&gt; 2021-06-03 09:16:31 INFO::No. regions with at least one SNP/gene for chr3 after merging: 17</span>
<span class="co">#&gt; 2021-06-03 09:16:31 INFO::No. regions with at least one SNP/gene for chr4: 17</span>
<span class="co">#&gt; 2021-06-03 09:16:31 INFO::Merge regions for chr4</span>
<span class="co">#&gt; 2021-06-03 09:16:31 INFO::No. regions with at least one SNP/gene for chr4 after merging: 16</span>
<span class="co">#&gt; 2021-06-03 09:16:31 INFO::No. regions with at least one SNP/gene for chr5: 17</span>
<span class="co">#&gt; 2021-06-03 09:16:31 INFO::Merge regions for chr5</span>
<span class="co">#&gt; 2021-06-03 09:16:31 INFO::No. regions with at least one SNP/gene for chr5 after merging: 17</span>
<span class="co">#&gt; 2021-06-03 09:16:31 INFO::No. regions with at least one SNP/gene for chr6: 17</span>
<span class="co">#&gt; 2021-06-03 09:16:31 INFO::Merge regions for chr6</span>
<span class="co">#&gt; 2021-06-03 09:16:31 INFO::No. regions with at least one SNP/gene for chr6 after merging: 17</span>
<span class="co">#&gt; 2021-06-03 09:16:31 INFO::No. regions with at least one SNP/gene for chr7: 17</span>
<span class="co">#&gt; 2021-06-03 09:16:31 INFO::Merge regions for chr7</span>
<span class="co">#&gt; 2021-06-03 09:16:31 INFO::No. regions with at least one SNP/gene for chr7 after merging: 16</span>
<span class="co">#&gt; 2021-06-03 09:16:31 INFO::No. regions with at least one SNP/gene for chr8: 17</span>
<span class="co">#&gt; 2021-06-03 09:16:31 INFO::Merge regions for chr8</span>
<span class="co">#&gt; 2021-06-03 09:16:31 INFO::No. regions with at least one SNP/gene for chr8 after merging: 16</span>
<span class="co">#&gt; 2021-06-03 09:16:31 INFO::No. regions with at least one SNP/gene for chr9: 17</span>
<span class="co">#&gt; 2021-06-03 09:16:31 INFO::Merge regions for chr9</span>
<span class="co">#&gt; 2021-06-03 09:16:31 INFO::No. regions with at least one SNP/gene for chr9 after merging: 17</span>
<span class="co">#&gt; 2021-06-03 09:16:31 INFO::No. regions with at least one SNP/gene for chr10: 17</span>
<span class="co">#&gt; 2021-06-03 09:16:31 INFO::Merge regions for chr10</span>
<span class="co">#&gt; 2021-06-03 09:16:31 INFO::No. regions with at least one SNP/gene for chr10 after merging: 16</span>
<span class="co">#&gt; 2021-06-03 09:16:31 INFO::No. regions with at least one SNP/gene for chr11: 17</span>
<span class="co">#&gt; 2021-06-03 09:16:31 INFO::Merge regions for chr11</span>
<span class="co">#&gt; 2021-06-03 09:16:31 INFO::No. regions with at least one SNP/gene for chr11 after merging: 16</span>
<span class="co">#&gt; 2021-06-03 09:16:31 INFO::No. regions with at least one SNP/gene for chr12: 17</span>
<span class="co">#&gt; 2021-06-03 09:16:31 INFO::Merge regions for chr12</span>
<span class="co">#&gt; 2021-06-03 09:16:31 INFO::No. regions with at least one SNP/gene for chr12 after merging: 16</span>
<span class="co">#&gt; 2021-06-03 09:16:31 INFO::No. regions with at least one SNP/gene for chr13: 17</span>
<span class="co">#&gt; 2021-06-03 09:16:31 INFO::Merge regions for chr13</span>
<span class="co">#&gt; 2021-06-03 09:16:31 INFO::No. regions with at least one SNP/gene for chr13 after merging: 16</span>
<span class="co">#&gt; 2021-06-03 09:16:31 INFO::No. regions with at least one SNP/gene for chr14: 17</span>
<span class="co">#&gt; 2021-06-03 09:16:31 INFO::Merge regions for chr14</span>
<span class="co">#&gt; 2021-06-03 09:16:31 INFO::No. regions with at least one SNP/gene for chr14 after merging: 16</span>
<span class="co">#&gt; 2021-06-03 09:16:32 INFO::No. regions with at least one SNP/gene for chr15: 17</span>
<span class="co">#&gt; 2021-06-03 09:16:32 INFO::Merge regions for chr15</span>
<span class="co">#&gt; 2021-06-03 09:16:32 INFO::No. regions with at least one SNP/gene for chr15 after merging: 16</span>
<span class="co">#&gt; 2021-06-03 09:16:32 INFO::No. regions with at least one SNP/gene for chr16: 17</span>
<span class="co">#&gt; 2021-06-03 09:16:32 INFO::Merge regions for chr16</span>
<span class="co">#&gt; 2021-06-03 09:16:32 INFO::No. regions with at least one SNP/gene for chr16 after merging: 17</span>
<span class="co">#&gt; 2021-06-03 09:16:32 INFO::No. regions with at least one SNP/gene for chr17: 17</span>
<span class="co">#&gt; 2021-06-03 09:16:32 INFO::Merge regions for chr17</span>
<span class="co">#&gt; 2021-06-03 09:16:32 INFO::No. regions with at least one SNP/gene for chr17 after merging: 16</span>
<span class="co">#&gt; 2021-06-03 09:16:32 INFO::No. regions with at least one SNP/gene for chr18: 17</span>
<span class="co">#&gt; 2021-06-03 09:16:32 INFO::Merge regions for chr18</span>
<span class="co">#&gt; 2021-06-03 09:16:32 INFO::No. regions with at least one SNP/gene for chr18 after merging: 16</span>
<span class="co">#&gt; 2021-06-03 09:16:32 INFO::No. regions with at least one SNP/gene for chr19: 17</span>
<span class="co">#&gt; 2021-06-03 09:16:32 INFO::Merge regions for chr19</span>
<span class="co">#&gt; 2021-06-03 09:16:32 INFO::No. regions with at least one SNP/gene for chr19 after merging: 17</span>
<span class="co">#&gt; 2021-06-03 09:16:32 INFO::No. regions with at least one SNP/gene for chr20: 17</span>
<span class="co">#&gt; 2021-06-03 09:16:32 INFO::Merge regions for chr20</span>
<span class="co">#&gt; 2021-06-03 09:16:32 INFO::No. regions with at least one SNP/gene for chr20 after merging: 17</span>
<span class="co">#&gt; 2021-06-03 09:16:32 INFO::No. regions with at least one SNP/gene for chr21: 17</span>
<span class="co">#&gt; 2021-06-03 09:16:32 INFO::Merge regions for chr21</span>
<span class="co">#&gt; 2021-06-03 09:16:32 INFO::No. regions with at least one SNP/gene for chr21 after merging: 17</span>
<span class="co">#&gt; 2021-06-03 09:16:32 INFO::No. regions with at least one SNP/gene for chr22: 17</span>
<span class="co">#&gt; 2021-06-03 09:16:32 INFO::Merge regions for chr22</span>
<span class="co">#&gt; 2021-06-03 09:16:32 INFO::No. regions with at least one SNP/gene for chr22 after merging: 17</span>
<span class="co">#&gt; 2021-06-03 09:16:32 INFO::Trim regions with SNPs more than 20</span>
<span class="co">#&gt; 2021-06-03 09:16:32 INFO::Adding R matrix info, as genotype is not given</span>
<span class="co">#&gt; 2021-06-03 09:16:32 INFO::Adding R matrix info for chrom 1</span>
<span class="co">#&gt; 2021-06-03 09:16:32 INFO::Adding R matrix info for chrom 2</span>
<span class="co">#&gt; 2021-06-03 09:16:32 INFO::Adding R matrix info for chrom 3</span>
<span class="co">#&gt; 2021-06-03 09:16:33 INFO::Adding R matrix info for chrom 4</span>
<span class="co">#&gt; 2021-06-03 09:16:33 INFO::Adding R matrix info for chrom 5</span>
<span class="co">#&gt; 2021-06-03 09:16:33 INFO::Adding R matrix info for chrom 6</span>
<span class="co">#&gt; 2021-06-03 09:16:33 INFO::Adding R matrix info for chrom 7</span>
<span class="co">#&gt; 2021-06-03 09:16:33 INFO::Adding R matrix info for chrom 8</span>
<span class="co">#&gt; 2021-06-03 09:16:33 INFO::Adding R matrix info for chrom 9</span>
<span class="co">#&gt; 2021-06-03 09:16:34 INFO::Adding R matrix info for chrom 10</span>
<span class="co">#&gt; 2021-06-03 09:16:34 INFO::Adding R matrix info for chrom 11</span>
<span class="co">#&gt; 2021-06-03 09:16:34 INFO::Adding R matrix info for chrom 12</span>
<span class="co">#&gt; 2021-06-03 09:16:34 INFO::Adding R matrix info for chrom 13</span>
<span class="co">#&gt; 2021-06-03 09:16:34 INFO::Adding R matrix info for chrom 14</span>
<span class="co">#&gt; 2021-06-03 09:16:34 INFO::Adding R matrix info for chrom 15</span>
<span class="co">#&gt; 2021-06-03 09:16:35 INFO::Adding R matrix info for chrom 16</span>
<span class="co">#&gt; 2021-06-03 09:16:35 INFO::Adding R matrix info for chrom 17</span>
<span class="co">#&gt; 2021-06-03 09:16:35 INFO::Adding R matrix info for chrom 18</span>
<span class="co">#&gt; 2021-06-03 09:16:35 INFO::Adding R matrix info for chrom 19</span>
<span class="co">#&gt; 2021-06-03 09:16:35 INFO::Adding R matrix info for chrom 20</span>
<span class="co">#&gt; 2021-06-03 09:16:35 INFO::Adding R matrix info for chrom 21</span>
<span class="co">#&gt; 2021-06-03 09:16:36 INFO::Adding R matrix info for chrom 22</span>
<span class="co">#&gt; 2021-06-03 09:16:36 INFO::Number of regions that contains strong gene signals: 1</span>
<span class="co">#&gt; 2021-06-03 09:16:36 INFO::Rerun susie for regions with strong gene signals using full SNPs.</span>
<span class="co">#&gt; 2021-06-03 09:16:36 INFO::run iteration 1</span>
<span class="co">#&gt; 2021-06-03 09:16:38 INFO::After iteration 1, gene prior 1:, SNP prior:0.0500167713726725</span></code></pre></div>
</div>
</div>
<div id="output-from-ctwas" class="section level1">
<h1 class="hasAnchor">
<a href="#output-from-ctwas" class="anchor"></a>Output from ctwas</h1>
<p><code>ctwas_rss</code> returns the estimated parameters (in the order of gene, SNP):</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pars</span>
<span class="co">#&gt; $group_prior</span>
<span class="co">#&gt; [1] 0.12885583 0.01050447</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $group_prior_var</span>
<span class="co">#&gt; [1] 293.2541393   0.2139139</span></code></pre></div>
<p>PIP results are given in <code>outname.susieIrss.txt</code>. This file contains PIP for each gene and SNP, please check <code>susie_pip</code> column.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fu">data.table</span><span class="fu">::</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/fread.html">fread</a></span><span class="op">(</span><span class="st">"~/temp/test_ss.susieIrss.txt"</span><span class="op">)</span><span class="op">)</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"chrom"</span>, <span class="st">"id"</span>, <span class="st">"pos"</span>, <span class="st">"type"</span>, <span class="st">"susie_pip"</span><span class="op">)</span><span class="op">]</span>
<span class="co">#&gt;    chrom     id pos type   susie_pip</span>
<span class="co">#&gt; 1:     1 rs1005   5  SNP 0.757344613</span>
<span class="co">#&gt; 2:     1 rs1006   6  SNP 0.002614718</span>
<span class="co">#&gt; 3:     1 rs1007   7  SNP 0.774952213</span>
<span class="co">#&gt; 4:     1 rs1008   8  SNP 0.002434619</span>
<span class="co">#&gt; 5:     1 rs1009   9  SNP 0.748231244</span>
<span class="co">#&gt; 6:     1 rs1010  10  SNP 0.686410868</span></code></pre></div>
<p>You will also notice a few auxilary/intermediate files produced by <code>ctwas_rss</code>. These files can be useful for diagnoiss.<code>.Rd</code> files contains parameters estimation updates with each iteration.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html">sessionInfo</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; R version 3.6.3 (2020-02-29)</span>
<span class="co">#&gt; Platform: x86_64-conda_cos6-linux-gnu (64-bit)</span>
<span class="co">#&gt; Running under: Scientific Linux 7.4 (Nitrogen)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Matrix products: default</span>
<span class="co">#&gt; BLAS:   /scratch/midway2/simingz/conda-envs/twas/lib/libblas.so.3.6.1</span>
<span class="co">#&gt; LAPACK: /scratch/midway2/simingz/conda-envs/twas/lib/liblapack.so.3.6.1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; locale:</span>
<span class="co">#&gt;  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              </span>
<span class="co">#&gt;  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    </span>
<span class="co">#&gt;  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   </span>
<span class="co">#&gt;  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 </span>
<span class="co">#&gt;  [9] LC_ADDRESS=C               LC_TELEPHONE=C            </span>
<span class="co">#&gt; [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; attached base packages:</span>
<span class="co">#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; other attached packages:</span>
<span class="co">#&gt; [1] ctwas_0.1.26</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; loaded via a namespace (and not attached):</span>
<span class="co">#&gt;  [1] Rcpp_1.0.5        compiler_3.6.3    pillar_1.4.6      iterators_1.0.12 </span>
<span class="co">#&gt;  [5] tools_3.6.3       digest_0.6.25     evaluate_0.14     memoise_1.1.0    </span>
<span class="co">#&gt;  [9] lifecycle_0.2.0   tibble_3.0.3      lattice_0.20-41   pkgconfig_2.0.3  </span>
<span class="co">#&gt; [13] rlang_0.4.7       Matrix_1.2-18     foreach_1.5.0     parallel_3.6.3   </span>
<span class="co">#&gt; [17] yaml_2.2.1        pkgdown_1.6.1     xfun_0.19         stringr_1.4.0    </span>
<span class="co">#&gt; [21] dplyr_1.0.0       knitr_1.29        pgenlibr_0.2      desc_1.2.0       </span>
<span class="co">#&gt; [25] generics_0.0.2    fs_1.4.2          vctrs_0.3.2       systemfonts_0.3.2</span>
<span class="co">#&gt; [29] rprojroot_2.0.2   grid_3.6.3        tidyselect_1.1.0  glue_1.4.1       </span>
<span class="co">#&gt; [33] data.table_1.12.8 R6_2.4.1          rmarkdown_2.6     purrr_0.3.4      </span>
<span class="co">#&gt; [37] magrittr_1.5      codetools_0.2-16  htmltools_0.5.0   ellipsis_0.3.1   </span>
<span class="co">#&gt; [41] assertthat_0.2.1  logging_0.10-108  ragg_0.3.1        stringi_1.4.6    </span>
<span class="co">#&gt; [45] doParallel_1.0.15 crayon_1.3.4</span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Siming Zhao.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
