<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Bayesian sum of single-effect (SuSiE) linear regression using z scores — susie_rss • ctwas</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Bayesian sum of single-effect (SuSiE) linear regression using z scores — susie_rss" />

<meta property="og:description" content="Bayesian sum of single-effect (SuSiE) linear regression using z scores" />





<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ctwas</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.16</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/ctwas_idv_wkfl.html">Run on individual-level data</a>
    </li>
    <li>
      <a href="../articles/ctwas_rss_wkfl.html">Run on summary statistics data</a>
    </li>
  </ul>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/simingz/ctwas">Source</a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Bayesian sum of single-effect (SuSiE) linear regression using z scores</h1>
    
    <div class="hidden name"><code>susie_rss.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Bayesian sum of single-effect (SuSiE) linear regression using z scores</p>
    
    </div>

    <pre class="usage"><span class='fu'>susie_rss</span><span class='op'>(</span><span class='va'>z</span>, <span class='va'>R</span>, maf <span class='op'>=</span> <span class='cn'>NULL</span>, maf_thresh <span class='op'>=</span> <span class='fl'>0</span>, z_ld_weight <span class='op'>=</span> <span class='fl'>0</span>,
  L <span class='op'>=</span> <span class='fl'>10</span>, prior_variance <span class='op'>=</span> <span class='fl'>50</span>, residual_variance <span class='op'>=</span> <span class='cn'>NULL</span>,
  r_tol <span class='op'>=</span> <span class='fl'>1e-08</span>, prior_weights <span class='op'>=</span> <span class='cn'>NULL</span>, null_weight <span class='op'>=</span> <span class='cn'>NULL</span>,
  estimate_residual_variance <span class='op'>=</span> <span class='cn'>TRUE</span>, estimate_prior_variance <span class='op'>=</span> <span class='cn'>TRUE</span>,
  estimate_prior_method <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"optim"</span>, <span class='st'>"EM"</span>, <span class='st'>"simple"</span><span class='op'>)</span>,
  check_null_threshold <span class='op'>=</span> <span class='fl'>0</span>, prior_tol <span class='op'>=</span> <span class='fl'>1e-09</span>, max_iter <span class='op'>=</span> <span class='fl'>100</span>,
  s_init <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span>, intercept_value <span class='op'>=</span> <span class='fl'>0</span>, coverage <span class='op'>=</span> <span class='fl'>0.95</span>,
  min_abs_corr <span class='op'>=</span> <span class='fl'>0.5</span>, tol <span class='op'>=</span> <span class='fl'>0.001</span>, verbose <span class='op'>=</span> <span class='cn'>FALSE</span>,
  track_fit <span class='op'>=</span> <span class='cn'>FALSE</span>, check_R <span class='op'>=</span> <span class='cn'>TRUE</span>, check_z <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span></pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>z</th>
      <td><p>a p vector of z scores.</p></td>
    </tr>
    <tr>
      <th>R</th>
      <td><p>a p by p symmetric and positive semidefinite correlation matrix. If it is from a reference panel,
we recommend a modification on correlation matrix with parameter `z_ld_weight`.</p></td>
    </tr>
    <tr>
      <th>maf</th>
      <td><p>minor allele frequency; to be used along with `maf_thresh` to filter input summary statistics</p></td>
    </tr>
    <tr>
      <th>maf_thresh</th>
      <td><p>variants having MAF smaller than this threshold will be filtered out</p></td>
    </tr>
    <tr>
      <th>z_ld_weight</th>
      <td><p>the weight assigned to the z in the ld matrix, the ld matrix used in model is cov2cor((1-w) R + w zz').
We recomment setting `z_ld_weight` as 1/number of samples in reference panel.</p></td>
    </tr>
    <tr>
      <th>L</th>
      <td><p>maximum number of non-zero effects</p></td>
    </tr>
    <tr>
      <th>prior_variance</th>
      <td><p>the prior variance (vector of length L, or scalar. In latter case gets repeated L times )</p></td>
    </tr>
    <tr>
      <th>residual_variance</th>
      <td><p>the residual variance, a scaler between 0 and 1</p></td>
    </tr>
    <tr>
      <th>r_tol</th>
      <td><p>tolerance level for eigen value check of positive semidefinite matrix of R.</p></td>
    </tr>
    <tr>
      <th>prior_weights</th>
      <td><p>a p vector of prior probability that each element is non-zero</p></td>
    </tr>
    <tr>
      <th>null_weight</th>
      <td><p>probability of no effect, for each single effect model</p></td>
    </tr>
    <tr>
      <th>estimate_residual_variance</th>
      <td><p>indicates whether to estimate residual variance</p></td>
    </tr>
    <tr>
      <th>estimate_prior_variance</th>
      <td><p>indicates whether to estimate prior</p></td>
    </tr>
    <tr>
      <th>estimate_prior_method</th>
      <td><p>The method used for estimating prior
variance. "simple" method only compares the loglikelihood between
using specified prior variance and using zero, and chose the one that
gives larger loglikelihood.</p></td>
    </tr>
    <tr>
      <th>check_null_threshold</th>
      <td><p>when prior variance is estimated, compare the
estimate with the null and set prior variance to null (zero) unless the log-likelihood
using the estimate is larger than that of null by this threshold. For example,
you can set it to 0.1 to nudge the estimate towards zero. Default is 0. Notice that setting it to non-zero
may lead to decreasing ELBO in some cases.</p></td>
    </tr>
    <tr>
      <th>prior_tol</th>
      <td><p>when prior variance is estimated, compare the estimated value to this tol at the end of
the analysis and exclude a single effect from PIP computation if the estimated prior variance is smaller than it.</p></td>
    </tr>
    <tr>
      <th>max_iter</th>
      <td><p>maximum number of iterations to perform</p></td>
    </tr>
    <tr>
      <th>s_init</th>
      <td><p>a previous susie fit with which to initialize</p></td>
    </tr>
    <tr>
      <th>intercept_value</th>
      <td><p>a value to assign to the intercept (since the intercept cannot be estimated from centered summary data). This
value will be used by coef.susie() to assign an intercept value, for consistency with the non-summary-statistic version of this function <code>susie</code>.
Set to NULL if you want coef.susie() not to include an intercept term (and so only return a p vector).</p></td>
    </tr>
    <tr>
      <th>coverage</th>
      <td><p>coverage of confident sets. Default to 0.95 for 95% credible interval.</p></td>
    </tr>
    <tr>
      <th>min_abs_corr</th>
      <td><p>minimum of absolute value of correlation allowed in a credible set.</p></td>
    </tr>
    <tr>
      <th>tol</th>
      <td><p>convergence tolerance based on elbo</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>if true outputs some progress messages</p></td>
    </tr>
    <tr>
      <th>track_fit</th>
      <td><p>add an attribute <code>trace</code> to output that saves current values of all iterations</p></td>
    </tr>
    <tr>
      <th>check_R</th>
      <td><p>check whether R is positive semidefinite</p></td>
    </tr>
    <tr>
      <th>check_z</th>
      <td><p>check whether z in space spanned by the non-zero eigenvectors of R</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>a susie fit, which is a list with some or all of the following elements<br /></p>
<dt>alpha</dt><dd><p>an L by p matrix of posterior inclusion probabilites</p></dd>
<dt>mu</dt><dd><p>an L by p matrix of posterior means (conditional on inclusion)</p></dd>
<dt>mu2</dt><dd><p>an L by p matrix of posterior second moments (conditional on inclusion)</p></dd>
<dt>Rr</dt><dd><p>an p vector of t(X) times fitted values, the fitted values equal to X times colSums(alpha*mu))</p></dd>
<dt>sigma2</dt><dd><p>residual variance</p></dd>
<dt>V</dt><dd><p>prior variance</p></dd>

    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Revised from susieR::susie_rss. Performs sum of single-effect (SuSiE) linear regression with z scores.
The summary data required are the p by p correlation matrix R, the p vector z. The summary stats should come from the same individuals.
This function fits the regression model z = sum_l Rb_l + e, where e is N(0,residual_variance * R) and the
sum_l b_l is a p vector of effects to be estimated.
The assumption is that each b_l has exactly one non-zero element, with all elements
equally likely to be non-zero. The prior on the non-zero element is N(0,var=prior_variance).</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>)</span>
<span class='va'>n</span>    <span class='op'>&lt;-</span> <span class='fl'>1000</span>
<span class='va'>p</span>    <span class='op'>&lt;-</span> <span class='fl'>1000</span>
<span class='va'>beta</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='va'>p</span><span class='op'>)</span>
<span class='va'>beta</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>4</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fl'>1</span>
<span class='va'>X</span>        <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='va'>n</span><span class='op'>*</span><span class='va'>p</span><span class='op'>)</span>,nrow<span class='op'>=</span><span class='va'>n</span>,ncol<span class='op'>=</span><span class='va'>p</span><span class='op'>)</span>
<span class='va'>y</span>        <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>X</span> <span class='op'>%*%</span> <span class='va'>beta</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='va'>n</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>input_ss</span> <span class='op'>&lt;-</span> <span class='fu'><a href='compute_ss.html'>compute_ss</a></span><span class='op'>(</span><span class='va'>X</span>,<span class='va'>y</span>,standardize <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
<span class='va'>ss</span> <span class='op'>&lt;-</span> <span class='fu'>univariate_regression</span><span class='op'>(</span><span class='va'>X</span>, <span class='va'>y</span><span class='op'>)</span>
<span class='va'>R</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/with.html'>with</a></span><span class='op'>(</span><span class='va'>input_ss</span>, <span class='fu'><a href='https://rdrr.io/r/stats/cor.html'>cov2cor</a></span><span class='op'>(</span><span class='va'>XtX</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>zhat</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/with.html'>with</a></span><span class='op'>(</span><span class='va'>ss</span>, <span class='va'>betahat</span><span class='op'>/</span><span class='va'>sebetahat</span><span class='op'>)</span>
<span class='co'># res &lt;- susie_rss(zhat, R)</span>

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Siming Zhao.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


