% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/ctwas_preprocess_weights.R
\name{preprocess_weights}
\alias{preprocess_weights}
\title{Preprocess PredictDB weights and harmonize with LD reference}
\usage{
preprocess_weights(
  weight_file,
  region_info,
  z_snp,
  weight_format = c("PredictDB", "Fusion"),
  drop_strand_ambig = TRUE,
  filter_protein_coding_genes = FALSE,
  load_predictdb_LD = FALSE,
  scale_by_ld_variance = TRUE
)
}
\arguments{
\item{weight_file}{a string, pointing to a directory with the fusion/twas format of weights, or a .db file in predictdb format.
A vector of multiple sets of weights in PredictDB format can also be specified; genes will have their filename appended
to their gene name to ensure IDs are unique.}

\item{region_info}{a data frame of region definition and associated file names.}

\item{z_snp}{A data frame with columns: "id", "A1", "A2", "z". giving the z scores for
snps. "A1" is effect allele. "A2" is the other allele. For harmonized data, A1 and A2 are not required.}

\item{weight_format}{weight format: PredictDB, or Fusion}

\item{drop_strand_ambig}{TRUE/FALSE, if TRUE remove strand ambiguous variants (A/T, G/C).}

\item{filter_protein_coding_genes}{TRUE/FALSE. If TRUE, keep protein coding genes only. This option is only for PredictDB weights}

\item{load_predictdb_LD}{TRUE/FALSE. If TRUE, load pre-computed LD among weight SNPs. This option is only for PredictDB weights}

\item{scale_by_ld_variance}{TRUE/FALSE. If TRUE, PredictDB weights are scaled by genotype variance, which is the default
behavior for PredictDB}
}
\value{
a list of processed weights
}
\description{
Preprocess PredictDB weights and harmonize with LD reference
}
